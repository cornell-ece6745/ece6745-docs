
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Christopher Batten">
      
      
      
        <link rel="prev" href="../ece6745-tut09-xcel-rtl/">
      
      
        <link rel="next" href="../ece6745-tut12-spice-sim/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Tutorial 10: SRAM Generators - ECE 6745 Complex Digital ASIC Design</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ece-6745-tutorial-10-sram-generators" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ECE 6745 Complex Digital ASIC Design" class="md-header__button md-logo" aria-label="ECE 6745 Complex Digital ASIC Design" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ECE 6745 Complex Digital ASIC Design
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tutorial 10: SRAM Generators
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/cornell-ece6745/ece6745-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    cornell-ece6745/ece6745-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ece6745-tut00-remote-access/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ece6745-sec01-asic-front-end/" class="md-tabs__link">
          
  
  
  Sections

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ECE 6745 Complex Digital ASIC Design" class="md-nav__button md-logo" aria-label="ECE 6745 Complex Digital ASIC Design" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ECE 6745 Complex Digital ASIC Design
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cornell-ece6745/ece6745-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    cornell-ece6745/ece6745-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut00-remote-access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 0: ECE Linux Server Remote Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut01-linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1: Linux Development Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut02-git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2: Git Distributed Version Control System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut05-asic-stdcells/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 5: ASIC Standard Cells
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut06-asic-front-end/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 6: ASIC Front-End Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut07-asic-back-end/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 7: ASIC Back-End Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut08-asic-auto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 8: ASIC Automated Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut09-xcel-rtl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 9: TinyRV2 Accelerator RTL Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tutorial 10: SRAM Generators
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tutorial 10: SRAM Generators
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-openram-memory-generator" class="md-nav__link">
    <span class="md-ellipsis">
      1. OpenRAM Memory Generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-srams-rtl-models" class="md-nav__link">
    <span class="md-ellipsis">
      2. SRAMs RTL Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. SRAMs RTL Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-testing-existing-sram-rtl-models" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. Testing Existing SRAM RTL Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-adding-a-new-sram-rtl-model" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. Adding a New SRAM RTL Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-sram-minion-wrapper-rtl" class="md-nav__link">
    <span class="md-ellipsis">
      3. SRAM Minion Wrapper RTL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-asic-front-end-flow-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      4. ASIC Front-End Flow with SRAM Macros
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. ASIC Front-End Flow with SRAM Macros">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-sram-generation" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. SRAM Generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-four-state-rtl-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Four-State RTL Simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-synthesis" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Synthesis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-fast-functional-gate-level-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      4.4. Fast-Functional Gate-Level Simulation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-asic-back-end-flow-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      5. ASIC Back-End Flow with SRAM Macros
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. ASIC Back-End Flow with SRAM Macros">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-place-and-route" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Place and Route
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-back-annotated-gate-level-simulation-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Back-Annotated Gate-Level Simulation with SRAM Macros
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-power-analysis-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      5.3. Power Analysis with SRAM Macros
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-asic-automated-flow-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      6. ASIC Automated Flow with SRAM Macros
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-to-do-on-your-own" class="md-nav__link">
    <span class="md-ellipsis">
      7. To-Do On Your Own
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut12-spice-sim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 12: SPICE Simulation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-tut13-dw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 13: DesignWare and Retiming
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sections
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Sections
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-sec01-asic-front-end/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Section 1: ASIC Front-End Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-sec02-asic-back-end/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Section 2: ASIC Back-End Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-sec03-asic-auto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Section 3: ASIC Automated Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-sec04-xcel-rtl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Section 4: TinyRV2 Accelerator RTL Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ece6745-sec05-sram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Section 5: SRAM Generators
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-openram-memory-generator" class="md-nav__link">
    <span class="md-ellipsis">
      1. OpenRAM Memory Generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-srams-rtl-models" class="md-nav__link">
    <span class="md-ellipsis">
      2. SRAMs RTL Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. SRAMs RTL Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-testing-existing-sram-rtl-models" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. Testing Existing SRAM RTL Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-adding-a-new-sram-rtl-model" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. Adding a New SRAM RTL Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-sram-minion-wrapper-rtl" class="md-nav__link">
    <span class="md-ellipsis">
      3. SRAM Minion Wrapper RTL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-asic-front-end-flow-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      4. ASIC Front-End Flow with SRAM Macros
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. ASIC Front-End Flow with SRAM Macros">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-sram-generation" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. SRAM Generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-four-state-rtl-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Four-State RTL Simulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-synthesis" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Synthesis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-fast-functional-gate-level-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      4.4. Fast-Functional Gate-Level Simulation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-asic-back-end-flow-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      5. ASIC Back-End Flow with SRAM Macros
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. ASIC Back-End Flow with SRAM Macros">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-place-and-route" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Place and Route
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-back-annotated-gate-level-simulation-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Back-Annotated Gate-Level Simulation with SRAM Macros
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-power-analysis-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      5.3. Power Analysis with SRAM Macros
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-asic-automated-flow-with-sram-macros" class="md-nav__link">
    <span class="md-ellipsis">
      6. ASIC Automated Flow with SRAM Macros
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-to-do-on-your-own" class="md-nav__link">
    <span class="md-ellipsis">
      7. To-Do On Your Own
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="ece-6745-tutorial-10-sram-generators">ECE 6745 Tutorial 10: SRAM Generators</h1>
<p>Small memories can be easily synthesized using flip-flop or latch
standard cells, but synthesizing large memories can significantly impact
the area, energy, and timing of the overall design. ASIC designers often
use SRAM generators to "generate" arrays of memory bitcells and the
corresponding peripheral circuitry (e.g., address decoders, bitline
drivers, sense amps) which are combined into what is called an "SRAM
macro". These SRAM generators are parameterized to enable generating a
wide range of SRAM macros with different numbers of rows, columns, and
column muxes, as well as optional support for partial writes, built-in
self-test, and error correction. Similar to a standard-cell library, an
SRAM generator must generate not just layout but also all of the
necessary views to capture logical functionality, timing, geometry, and
power usage. These views can then by used by the ASIC tools to produce a
complete design which includes a mix of both standard cells and SRAM
macros.</p>
<p>The tutorial will first describe how to use the open-source OpenRAM
memory generator to generate various views of an SRAM macro. You will
then see how to use an SRAM in an RTL model, how to generate the
corresponding SRAM macro, and then how to push a design which uses an
SRAM macro through the manual ASIC flow. Finally, you will see how to use
pyhflow to automate this process. This tutorial assumes you have already
completed the tutorials on Linux, Git, PyMTL, Verilog, ASIC front-end
flow, ASIC back-end flow, and ASIC automated ASIC flow.</p>
<p>The first step is to access <code>ecelinux</code>. Use VS Code to log into a
specific <code>ecelinux</code> server and then use Microsoft Remote Desktop to log
into the same server. Once you are at the <code>ecelinux</code> prompt, source the
setup script, source the GUI setup script, clone this repository from
GitHub, and define an environment variable to keep track of the top
directory for the project.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>%<span class="w"> </span><span class="nb">source</span><span class="w"> </span>setup-ece6745.sh
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>%<span class="w"> </span><span class="nb">source</span><span class="w"> </span>setup-gui.sh
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>%<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$HOME</span>/ece6745
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$HOME</span>/ece6745
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>%<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:cornell-ece6745/ece6745-tut10-sram<span class="w"> </span>tut10
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>tut10
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>%<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">TOPDIR</span><span class="o">=</span><span class="nv">$PWD</span>
</span></code></pre></div>
<h2 id="1-openram-memory-generator">1. OpenRAM Memory Generator</h2>
<p>Just as with standard-cell libraries, acquiring real SRAM generators is a
complex and potentially expensive process. It requires gaining access to
a specific fabrication technology, negotiating with a company which makes
the SRAM generator, and usually signing multiple non-disclosure
agreements. The OpenRAM memory generator is based on the same "fake" 45nm
technology that we are using for the Nangate standard-cell library. The
"fake" technology is representative enough to provide reasonable area,
energy, and timing estimates for our purposes. In this section, we will
take a look at how to use the OpenRAM memory generator to generate
various views of an SRAM macro.</p>
<p>An SRAM generator takes as input a configuration file which specifies the
various parameters for the desired SRAM macro. Let's go ahead and create
such a configuration file for a small SRAM. For this section of the
tutorial, we will work in the <code>openram</code> subdirectory. The name of the
configuration file should be <code>SRAM_32x128_1rw_cfg.py</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>%<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$TOPDIR</span>/openram
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>%<span class="w"> </span>code<span class="w"> </span>SRAM_32x128_1rw_cfg.py
</span></code></pre></div>
<p>The configuration file should look like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>use_conda       = False
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>num_rw_ports    = 1
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>num_r_ports     = 0
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>num_w_ports     = 0
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>word_size       = 32
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>num_words       = 128
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>num_banks       = 1
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>words_per_row   = 4
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>write_size      = 8
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>tech_name       = &quot;freepdk45&quot;
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>process_corners = [&quot;TT&quot;]
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>supply_voltages = [1.1]
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>temperatures    = [25]
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>route_supplies  = True
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>check_lvsdrc    = False
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>output_path     = &quot;SRAM_32x128_1rw&quot;
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>output_name     = &quot;SRAM_32x128_1rw&quot;
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>instance_name   = &quot;SRAM_32x128_1rw&quot;
</span></code></pre></div>
<p>In this example, we are generating a single-ported SRAM which has 128
rows and 32 bits per row for a total capacity of 4096 bits or 512B. This
size is probably near the cross-over point where you might transition
from using synthesized memories to SRAM macros. OpenRAM will take this
configuration file as input and generate many different views of the SRAM
macro including: schematics (<code>.sp</code>), layout (<code>.gds</code>), a Verilog
behavioral model (<code>.v</code>), abstract logical, timing, power view (<code>.lib</code>),
and a physical view (<code>.lef</code>). These views can then be used by the ASIC
tools.</p>
<p>You can use the following command to run the OpenRAM memory generator.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>-p<span class="w"> </span><span class="nv">$TOPDIR</span>/openram
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>%<span class="w"> </span>openram<span class="w"> </span>-v<span class="w"> </span>-v<span class="w"> </span>SRAM_32x128_1rw_cfg.py
</span></code></pre></div>
<p>It will take about 4-5 minutes to generate the SRAM macro. You can see
the resulting views here:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/openram/SRAM_32x128_1rw
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>%<span class="w"> </span>ls<span class="w"> </span>-1
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>SRAM_32x128_1rw.v
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>SRAM_32x128_1rw.sp
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>SRAM_32x128_1rw.gds
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>SRAM_32x128_1rw.lef
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>SRAM_32x128_1rw_TT_1p1V_25C.lib
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>SRAM_32x128_1rw.html
</span></code></pre></div>
<p>You can find more information about the OpenRAM memory generator on the
project's webpage here:</p>
<ul>
<li><a href="https://openram.org">https://openram.org</a></li>
</ul>
<p>Or in this research paper:</p>
<ul>
<li>M. Guthaus et. al, "OpenRAM: An Open-Source Memory Compiler", Int'l
   Conf. on Computer-Aided Design (ICCAD), Nov. 2016.
   (https://doi.org/10.1145/2966986.2980098)</li>
</ul>
<p>The following excerpt from the paper illustrates the microarchitecture
used in the single-port SRAM macro in the original OpenRAM
implementation.</p>
<p><img alt="" src="../img/tut10-openram-sram-uarch.png" /></p>
<p>The functionality of the pins are as follows:</p>
<ul>
<li><code>clk</code>: clock</li>
<li><code>WEb</code>: write enable (active low)</li>
<li><code>OEb</code>: output enable (active low)</li>
<li><code>CSb</code>: whole SRAM enable (active low)</li>
<li><code>ADDR</code>: address</li>
<li><code>DATA</code>: read/write data</li>
</ul>
<p>Notice that there is a single address, and a single read/write data bus.
In the new version of OpenRAM that we are currently using, this has been
changed to use a separate read data and write data bus. However, this
SRAM macro still only supports executing a single transaction at a time.
The new version of OpenRAM has also removed the output enable control
signal. The diagram shows a bank select which is used when a single SRAM
macro is built out of multiple lower-level "physical banks" to produce a
more efficient layout (by means of reducing the length of bitlines and
wordlines, hence improving delay and energy efficiency). To achieve
similar results, we instead use a column muxing factor, which allows us
to read multiple lines and select the data we want via a MUX, hence also
creating a more efficient layout. We will see what the column muxing
looks like a little later in the tutorial.</p>
<p>The following excerpt from the paper shows the timing diagram for a read
and write transaction in the old OpenRAM implementation, which for the
most part holds for the most recent version.</p>
<p><img alt="" src="../img/tut10-openram-sram-timing.png" /></p>
<p>In order to execute any kind of transaction in the SRAM, we need to set
the <code>CSb</code> pin low (note that <code>CSb</code> is active low). Let's start by
focusing on the read transaction shown on the left. For the read
transaction on the left, the <code>WEb</code> pin is set high (note that <code>WEB</code> is
active low). The <code>ADDR</code> pins are used to set the row address. Note that
this is a <em>row</em> address not a <em>byte</em> address. From the block diagram, we
can see that the address first goes into the "Address MS-Flop". This is
an array of flip-flops which store the address on the rising edge of the
clock. After the rising edge, the address is decoded to drive the word
lines and enable the desired row. The read data is driven from the bit
cell array through the column muxing and into the sense amp array. The
<code>OEb</code> pin was used to determine whether the read data should be driven
onto the data bus. This can enable multiple SRAM macros to be arranged on
a distributed bus with only one SRAM driving that bus on any given cycle.
The <code>OEb</code> pin has since been removed in OpenRAM, and its functionality
was tied to the <code>CSb</code> pin. Assuming <code>CSb</code> is low, then the read data is
driven out the <code>DATA</code> pins. Since we set the address <em>before</em> the edge
and the data is valid <em>after</em> the edge, this is a <em>synchronous</em> read
SRAM. Compare this to a register file which often provides a
<em>combinational</em> read where the address is set and the data is valid
sometime later during the <em>same</em> cycle. Most SRAM generators produce
synchronous read SRAM macros. For the write transaction on the right, the
<code>WEb</code> pin is set low and the <code>DATA</code> pins are driven with the write data.</p>
<p>You can look at the behavioral Verilog produced by the OpenRAM memory
generator like this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/openram/SRAM_32x128_1rw
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>%<span class="w"> </span>less<span class="w"> </span>SRAM_32x128_1rw.v
</span></code></pre></div>
<p>The Verilog file should look like this:</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">module</span><span class="w"> </span><span class="n">SRAM_32x128_1rw</span><span class="p">(</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="n">clk0</span><span class="p">,</span><span class="n">csb0</span><span class="p">,</span><span class="n">web0</span><span class="p">,</span><span class="n">wmask0</span><span class="p">,</span><span class="n">addr0</span><span class="p">,</span><span class="n">din0</span><span class="p">,</span><span class="n">dout0</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">NUM_WMASKS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">DATA_WIDTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">32</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">ADDR_WIDTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">7</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">RAM_DEPTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ADDR_WIDTH</span><span class="p">;</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span><span class="c1">// FIXME: This delay is arbitrary.</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">DELAY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">3</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">VERBOSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//Set to 0 to only display warnings</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">T_HOLD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1">//Delay to hold dout value after posedge. Value is arbitrary</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="n">clk0</span><span class="p">;</span><span class="w"> </span><span class="c1">// clock</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">  </span><span class="k">input</span><span class="w">   </span><span class="n">csb0</span><span class="p">;</span><span class="w"> </span><span class="c1">// active low chip select</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="n">web0</span><span class="p">;</span><span class="w"> </span><span class="c1">// active low write control</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">  </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">addr0</span><span class="p">;</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">  </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="n">NUM_WMASKS</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">   </span><span class="n">wmask0</span><span class="p">;</span><span class="w"> </span><span class="c1">// write mask</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">  </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">din0</span><span class="p">;</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">  </span><span class="k">output</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">dout0</span><span class="p">;</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">  </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">    </span><span class="n">mem</span><span class="w"> </span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="n">RAM_DEPTH</span><span class="o">-</span><span class="mh">1</span><span class="p">];</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">  </span><span class="kt">reg</span><span class="w">  </span><span class="n">csb0_reg</span><span class="p">;</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="w">  </span><span class="kt">reg</span><span class="w">  </span><span class="n">web0_reg</span><span class="p">;</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="w">  </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="n">NUM_WMASKS</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">   </span><span class="n">wmask0_reg</span><span class="p">;</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="w">  </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">addr0_reg</span><span class="p">;</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="w">  </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">din0_reg</span><span class="p">;</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="w">  </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">dout0</span><span class="p">;</span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a><span class="w">  </span><span class="c1">// All inputs are registers</span>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="w">  </span><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk0</span><span class="p">)</span>
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="w">    </span><span class="n">csb0_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">csb0</span><span class="p">;</span>
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="w">    </span><span class="n">web0_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">web0</span><span class="p">;</span>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a><span class="w">    </span><span class="n">wmask0_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">wmask0</span><span class="p">;</span>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a><span class="w">    </span><span class="n">addr0_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">addr0</span><span class="p">;</span>
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="w">    </span><span class="n">din0_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">din0</span><span class="p">;</span>
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a><span class="w">    </span><span class="n">dout0</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">32</span><span class="p">&#39;</span><span class="n">bx</span><span class="p">;</span>
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">csb0_reg</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">web0_reg</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">VERBOSE</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a><span class="w">      </span><span class="nb">$display</span><span class="p">(</span><span class="nb">$time</span><span class="p">,</span><span class="s">&quot; Reading %m addr0=%b dout0=%b&quot;</span><span class="p">,</span><span class="n">addr0_reg</span><span class="p">,</span><span class="n">mem</span><span class="p">[</span><span class="n">addr0_reg</span><span class="p">]);</span>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">csb0_reg</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">web0_reg</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">VERBOSE</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a><span class="w">      </span><span class="nb">$display</span><span class="p">(</span><span class="nb">$time</span><span class="p">,</span><span class="s">&quot; Writing %m addr0=%b din0=%b wmask0=%b&quot;</span><span class="p">,</span><span class="n">addr0_reg</span><span class="p">,</span><span class="n">din0_reg</span><span class="p">,</span><span class="n">wmask0_reg</span><span class="p">);</span>
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a><span class="w">  </span><span class="c1">// Memory Write Block Port 0</span>
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a><span class="w">  </span><span class="c1">// Write Operation : When web0 = 0, csb0 = 0</span>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a><span class="w">  </span><span class="k">always</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="p">(</span><span class="k">negedge</span><span class="w"> </span><span class="n">clk0</span><span class="p">)</span>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a><span class="w">  </span><span class="k">begin</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">MEM_WRITE0</span>
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">csb0_reg</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">web0_reg</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wmask0_reg</span><span class="p">[</span><span class="mh">0</span><span class="p">])</span>
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a><span class="w">                </span><span class="n">mem</span><span class="p">[</span><span class="n">addr0_reg</span><span class="p">][</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">din0_reg</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wmask0_reg</span><span class="p">[</span><span class="mh">1</span><span class="p">])</span>
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a><span class="w">                </span><span class="n">mem</span><span class="p">[</span><span class="n">addr0_reg</span><span class="p">][</span><span class="mh">15</span><span class="o">:</span><span class="mh">8</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">din0_reg</span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">8</span><span class="p">];</span>
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wmask0_reg</span><span class="p">[</span><span class="mh">2</span><span class="p">])</span>
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a><span class="w">                </span><span class="n">mem</span><span class="p">[</span><span class="n">addr0_reg</span><span class="p">][</span><span class="mh">23</span><span class="o">:</span><span class="mh">16</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">din0_reg</span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">16</span><span class="p">];</span>
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wmask0_reg</span><span class="p">[</span><span class="mh">3</span><span class="p">])</span>
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a><span class="w">                </span><span class="n">mem</span><span class="p">[</span><span class="n">addr0_reg</span><span class="p">][</span><span class="mh">31</span><span class="o">:</span><span class="mh">24</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">din0_reg</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">24</span><span class="p">];</span>
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-6-60"><a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-6-61"><a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a>
</span><span id="__span-6-62"><a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a><span class="w">  </span><span class="c1">// Memory Read Block Port 0</span>
</span><span id="__span-6-63"><a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a><span class="w">  </span><span class="c1">// Read Operation : When web0 = 1, csb0 = 0</span>
</span><span id="__span-6-64"><a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a><span class="w">  </span><span class="k">always</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="p">(</span><span class="k">negedge</span><span class="w"> </span><span class="n">clk0</span><span class="p">)</span>
</span><span id="__span-6-65"><a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a><span class="w">  </span><span class="k">begin</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">MEM_READ0</span>
</span><span id="__span-6-66"><a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">csb0_reg</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">web0_reg</span><span class="p">)</span>
</span><span id="__span-6-67"><a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a><span class="w">       </span><span class="n">dout0</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">mem</span><span class="p">[</span><span class="n">addr0_reg</span><span class="p">];</span>
</span><span id="__span-6-68"><a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-6-69"><a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a>
</span><span id="__span-6-70"><a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a><span class="k">endmodule</span>
</span></code></pre></div>
<p>This is a simple behavior Verilog model which could be used for RTL or
gate-level simulation. If you study this behavioral model you should be
able to see the timing diagrams it implements, and the slight variations
from the original OpenRAM implementation described in the paper. Again,
notice that all inputs are registered on the positive edge, and the read
operation is modeled using an <code>always @(negedge clk)</code> block to reflect
the fact that this SRAM uses a <em>sequential</em> read based on the clock.</p>
<p>You can take a look at the generated transistor-level netlist like this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/openram/SRAM_32x128_1rw
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>%<span class="w"> </span>less<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot; cell_1rw &quot;</span><span class="w"> </span>SRAM_32x128_1rw.sp
</span></code></pre></div>
<p>The netlist for the bitcell should look like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>.SUBCKT cell_1rw bl br wl vdd gnd
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a> * Inverter 1
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a> MM0 Q_bar Q gnd gnd NMOS_VTG W=205.00n L=50n
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a> MM4 Q_bar Q vdd vdd PMOS_VTG W=90n     L=50n
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a> * Inverter 2
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a> MM1 Q Q_bar gnd gnd NMOS_VTG W=205.00n L=50n
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a> MM5 Q Q_bar vdd vdd PMOS_VTG W=90n     L=50n
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a> * Access transistors
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a> MM3 bl wl Q gnd NMOS_VTG W=135.00n L=50n
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a> MM2 br wl Q_bar gnd NMOS_VTG W=135.00n L=50n
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>.ENDS cell_1rw
</span></code></pre></div>
<p>This is showing the netlist for one bitcell in the SRAM. This is a
classic 6T SRAM bitcell with two cross-coupled inverters (<code>MM0</code>, <code>MM4</code>,
<code>MM1</code>, <code>MM5</code>) and two access transistors (<code>MM2</code>, <code>MM3</code>). Note that the
transistors must be carefully sized to ensure correct operation of an
SRAM bitcell!</p>
<p>Now let's use Klayout look at the actual layout produced by the OpenRAM
memory generator.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/openram/SRAM_32x128_1rw
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>%<span class="w"> </span>klayout<span class="w"> </span>-l<span class="w"> </span><span class="nv">$ECE6745_STDCELLS</span>/klayout.lyp<span class="w"> </span>SRAM_32x128_1rw.gds
</span></code></pre></div>
<p>The following figure shows the layout for the SRAM macro. In Klayout, you
can show/hide layers by double clicking on them on the right panel. You
can show more of the hierarchy by selecting <em>Display &gt; Increment
Hierarchy</em> from the menu.</p>
<p><img alt="" src="../img/tut10-openram-sram-32x128-1rw.png" /></p>
<p>Use a ruler in Klayout to measure the height and width
of the SRAM macro. It should be about 140um wide by 75um tall.</p>
<p>On the left we have flops for the row addresses, which are then fed into
a decoder. The decoder activates a certain wordline driver, which will
then read out the data through the circuitry below (with the column
muxing and sense amps shown in more detail in the following image). Also
note that in the above image, the circuitry at the bottom are the flops
for the read data.</p>
<p>Notice how at the bottom of the SRAM, above the data flops, we have
circuitry distributed every four rows of the SRAM. This is the column
muxing circuitry that we added in our configuration file and mentioned
previously. The following figure shows a closer look at this column
muxing circuitry and the sense amps.</p>
<p><img alt="" src="../img/tut10-openram-sram-32x128-1rw-colmux.png" /></p>
<p>The following figure shows the layout for a single SRAM bitcell.</p>
<p><img alt="" src="../img/tut10-openram-sram-bitcell.png" /></p>
<p>The word line is routed horizontally on M1 (blue) and the bit lines are
routed vertically on M2 (green). It looks like power and ground are
routed both vertically and horizontally. See if you can map the layout to
the canonical 6T SRAM bitcell transistor-level implementation.</p>
<p>Let’s look at snippet of the <code>.lib</code> file for the SRAM macro.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/openram/SRAM_32x128_1rw
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>%<span class="w"> </span>less<span class="w"> </span>SRAM_32x128_1rw_TT_1p1V_25C.lib
</span></code></pre></div>
<p>The <code>.lib</code> should look like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a> cell (SRAM_32x128_1rw) {
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>   ...
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>   area : 10711.8116;
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>   ...
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>   bus (dout0) {
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>     bus_type        : data;
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>     direction       : output;
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>     max_capacitance : 0.0008364000000000001;
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>     min_capacitance : 5.2275000000000003e-05;
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>     memory_read() {
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>       address : addr0;
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>     }
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>     pin(dout0[31:0]) {
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>       timing(){
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>         timing_sense : non_unate;
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>         related_pin  : &quot;clk0&quot;;
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>         timing_type  : falling_edge;
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>         cell_rise(CELL_TABLE) {
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>           values(&quot;0.293, 0.293, 0.294&quot;,\
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>                  &quot;0.293, 0.293, 0.294&quot;,\
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>                  &quot;0.293, 0.293, 0.294&quot;);
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>         }
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>         cell_fall(CELL_TABLE) {
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>           values(&quot;0.293, 0.293, 0.294&quot;,\
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>                  &quot;0.293, 0.293, 0.294&quot;,\
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>                  &quot;0.293, 0.293, 0.294&quot;);
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>         }
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>         rise_transition(CELL_TABLE) {
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>           values(&quot;0.001, 0.001, 0.001&quot;,\
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>                  &quot;0.001, 0.001, 0.001&quot;,\
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>                  &quot;0.001, 0.001, 0.001&quot;);
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a>         }
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a>         fall_transition(CELL_TABLE) {
</span><span id="__span-11-34"><a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a>           values(&quot;0.001, 0.001, 0.001&quot;,\
</span><span id="__span-11-35"><a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a>                  &quot;0.001, 0.001, 0.001&quot;,\
</span><span id="__span-11-36"><a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a>                  &quot;0.001, 0.001, 0.001&quot;);
</span><span id="__span-11-37"><a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a>         }
</span><span id="__span-11-38"><a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a>       }
</span><span id="__span-11-39"><a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a>     }
</span><span id="__span-11-40"><a id="__codelineno-11-40" name="__codelineno-11-40" href="#__codelineno-11-40"></a>   }
</span><span id="__span-11-41"><a id="__codelineno-11-41" name="__codelineno-11-41" href="#__codelineno-11-41"></a>   ...
</span><span id="__span-11-42"><a id="__codelineno-11-42" name="__codelineno-11-42" href="#__codelineno-11-42"></a> }
</span></code></pre></div>
<p>As with the standard-cell library, the <code>.lib</code> includes information about
the area of the block, the capacitance on all pins, and power of the
circuit. By default OpenRAM will use analytical models to estimate this
characterization data which is probably why the timing values are not
varying too much within a look-up table. OpenRAM can also use SPICE
simulations to estimate this characterization data. These simulations
will result in the memory compiler taking significantly longer to
generate the SRAM macros, but will also result in much more accurate
characterization data.</p>
<p>The <code>.lef</code> file will mostly contain large rectangular blockages which
mean that the ASIC tools should not route any M1, M2, M3 wires over the
SRAM (because they would accidentally create short circuits with the M1,
M2, M3 wires already in the SRAM macro). The <code>.lef</code> file also identifies
where all of the pins are physically located so the ASIC tools can
correctly connect to the SRAM macro.</p>
<h2 id="2-srams-rtl-models">2. SRAMs RTL Models</h2>
<p>Now that we understand how an SRAM generator works, let's see how to
actually use an SRAM in your RTL models. Our basic SRAMs are located in
the <code>sim/sram</code> subdirectory.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/sram
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>%<span class="w"> </span>ls
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>...
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>SRAM_generic.v
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>SRAM.v
</span></code></pre></div>
<p>Take a look the interface of the SRAM in <code>SRAM.v</code>.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">module</span><span class="w"> </span><span class="n">sram_SRAM</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="p">#(</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">p_data_nbits</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">32</span><span class="p">,</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">p_num_entries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">256</span><span class="p">,</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">  </span><span class="c1">// Local constants not meant to be set from outside the module</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">c_addr_nbits</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">$clog2</span><span class="p">(</span><span class="n">p_num_entries</span><span class="p">),</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">c_data_nbytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p_data_nbits</span><span class="o">+</span><span class="mh">7</span><span class="p">)</span><span class="o">/</span><span class="mh">8</span><span class="w"> </span><span class="c1">// $ceil(p_data_nbits/8)</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="p">)(</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">                        </span><span class="n">clk</span><span class="p">,</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">                        </span><span class="n">reset</span><span class="p">,</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">                        </span><span class="n">port0_val</span><span class="p">,</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">                        </span><span class="n">port0_type</span><span class="p">,</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">c_addr_nbits</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">     </span><span class="n">port0_idx</span><span class="p">,</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="p">[(</span><span class="n">p_data_nbits</span><span class="o">/</span><span class="mh">8</span><span class="p">)</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">port0_wben</span><span class="p">,</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">p_data_nbits</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">     </span><span class="n">port0_wdata</span><span class="p">,</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">  </span><span class="k">output</span><span class="w"> </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">p_data_nbits</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">     </span><span class="n">port0_rdata</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="p">);</span>
</span></code></pre></div>
<p>The SRAM model is parameterized by the number of words and the bits per
word, and has the following pin-level interface:</p>
<ul>
<li><code>port0_val</code>: port enable</li>
<li><code>port0_type</code>: transaction type (0 = read, 1 = write)</li>
<li><code>port0_idx</code>: which row to read/write</li>
<li><code>port0_wben</code>: write byte enables</li>
<li><code>port0_wdata</code>: write data</li>
<li><code>port0_rdata</code>: read data</li>
</ul>
<p>Now look at the implementation of the SRAM. You will see a generate if
statement which uses the parameters to either: (1) instantiate an SRAM
macro RTL model or (2) instantiate an SRAM generic RTL model. Although
you can instantiate an SRAM with any number of words and bits per word,
this SRAM will only result in a real SRAM macro if these parameters match
one of the existing SRAM macros in the generate statement. If the
parameters do not match one of the existing SRAM macros, then the SRAM
RTL model will still behave correctly in simulation but will result in
synthesizing the memory out of flip-flops. Note that it is critical that
the name of any specific SRAM macro matches the exact name generated by
OpenRAM.</p>
<h3 id="21-testing-existing-sram-rtl-models">2.1. Testing Existing SRAM RTL Models</h3>
<p>Let's test an SRAM with 256 words and 32 bits per word. You can see the
corresponding test case in <code>SRAM_test.py</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/sram/test
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>%<span class="w"> </span>cat<span class="w"> </span>SRAM_test.py
</span></code></pre></div>
<p>The test case should look as follows.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>def test_direct_32x256( cmdline_opts ):
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>  run_test_vector_sim( SRAM(32, 256), [ header_str,
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    # val type idx  wben    wdata       rdata
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    [ 1,  1,  0x00, 0b1111, 0x00000000, &#39;?&#39;        ], # write 0x00
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    [ 1,  0,  0x00, 0b1111, 0x00000000, &#39;?&#39;        ], # read  0x00
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    [ 0,  0,  0x00, 0b1111, 0x00000000, 0x00000000 ], # check read data
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>    [ 1,  1,  0x00, 0b1111, 0xdeadbeef, &#39;?&#39;        ], # write 0x00
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>    [ 1,  0,  0x00, 0b1111, 0x00000000, &#39;?&#39;        ], # read  0x00
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>    [ 0,  0,  0x00, 0b1111, 0x00000000, 0xdeadbeef ], # check read data
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>    [ 1,  1,  0x01, 0b1111, 0xcafecafe, &#39;?&#39;        ], # write 0x01
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>    [ 1,  0,  0x01, 0b1111, 0x00000000, &#39;?&#39;        ], # read  0x01
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>    [ 0,  0,  0x00, 0b1111, 0x00000000, 0xcafecafe ], # check read data
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>    [ 1,  1,  0x1f, 0b1111, 0x0a0a0a0a, &#39;?&#39;        ], # write 0x1f
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>    [ 1,  0,  0x1f, 0b1111, 0x00000000, &#39;?&#39;        ], # read  0x1f
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>    [ 0,  0,  0x00, 0b1111, 0x00000000, 0x0a0a0a0a ], # check read data
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>...
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>]```
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>Each row represents the inputs and expected outputs for that cycle. In
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>the first cycle, we write 0x00000000 to address 0x00. In the second
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>cycle, we read address 0x00. In the first cycle, we check to ensure the
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a>read data is correct. Since the SRAM supports synchronous read, the read
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>data is returned the cycle _after_ we specify the read address! Let&#39;s run
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a>the tests for this SRAM.
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>```bash
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a>% mkdir -p $TOPDIR/sim/build
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>% cd $TOPDIR/sim/build
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a>% pytest ../sram/test/SRAM_test.py -k test_direct_32x256 -s
</span></code></pre></div>
<p>You can run the random test like this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/build
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>%<span class="w"> </span>pytest<span class="w"> </span>../sram/test/SRAM_test.py<span class="w"> </span>-k<span class="w"> </span>test_random<span class="o">[</span><span class="m">32</span>-256<span class="o">]</span><span class="w"> </span>-s
</span></code></pre></div>
<h3 id="22-adding-a-new-sram-rtl-model">2.2. Adding a New SRAM RTL Model</h3>
<p>As mentioned above, the SRAM module is parameterized to enable initial
design space exploration, but just because we choose a specific SRAM
configuration does not mean the files we need to create the corresponding
SRAM macro exist yet. Once we have finalized the SRAM size, we need to go
through a five step process to ensure we can run OpenRAM and generate the
corresponding SRAM macro.</p>
<p><strong>Step 1: See if SRAM configuration already exists</strong></p>
<p>The first step is to see if your desired SRAM configuration already
exists. You can do this by looking at the names of the <code>_cfg.py</code> files in
the <code>sim/sram</code> subdirectory.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/sram
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>%<span class="w"> </span>ls<span class="w"> </span>*_cfg.py
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>SRAM_128x256_1rw-cfg.py
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>SRAM_32x256_1rw-cfg.py
</span></code></pre></div>
<p>This means there are two SRAM configurations already available. One SRAM
has 256 words each with 128 bits and the other SRAM has 256 words each
with 32 bits. If the SRAM configuration you need already exists then you
are done and can skip the remaining steps.</p>
<p><strong>Step 2: Create SRAM configuration file</strong></p>
<p>The next step is to create a new SRAM configuration file. You must use a
very specific naming scheme. An SRAM with <code>N</code> words and <code>M</code> bits per word
must be named <code>SRAM_MxN_1rw_cfg.py</code>. Go ahead and create a new SRAM
configuration file named <code>SRAM_32x128_1rw_cfg.py</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/sram
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>%<span class="w"> </span>code<span class="w"> </span>SRAM_32x128_1rw-cfg.py
</span></code></pre></div>
<p>The SRAM configuration file should contain the following contents:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>use_conda       = False
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>num_rw_ports    = 1
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>num_r_ports     = 0
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>num_w_ports     = 0
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>word_size       = 32
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>num_words       = 128
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>num_banks       = 1
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>words_per_row   = 4
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>write_size      = 8
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>tech_name       = &quot;freepdk45&quot;
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>process_corners = [&quot;TT&quot;]
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>supply_voltages = [1.1]
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>temperatures    = [25]
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>route_supplies  = True
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>check_lvsdrc    = False
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>output_path     = &quot;SRAM_32x128_1rw&quot;
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>output_name     = &quot;SRAM_32x128_1rw&quot;
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>instance_name   = &quot;SRAM_32x128_1rw&quot;
</span></code></pre></div>
<p><strong>Step 3: Create an SRAM macro RTL model</strong></p>
<p>The next step is to create an SRAM macro RTL model. This new RTL model
should have the same name as the configuration file except with <code>.v</code>
instead of <code>_cfg.py</code>. You can use the SRAM generic RTL model to implement
the SRAM macro RTL model. Go ahead and create an SRAM macro RTL model for
the 32x128 configuration.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/sram
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>%<span class="w"> </span>code<span class="w"> </span>SRAM_32x128_1rw.v
</span></code></pre></div>
<p>The SRAM macro RTL model should contain the following contents.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="no">`ifndef</span><span class="w"> </span><span class="n">SRAM_32x128_1rw</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="cp">`define SRAM_32x128_1rw</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="no">`include</span><span class="w"> </span><span class="s">&quot;sram/SramGenericVRTL.v&quot;</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="no">`ifndef</span><span class="w"> </span><span class="n">SYNTHESIS</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="k">module</span><span class="w"> </span><span class="n">SRAM_32x128_1rw</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="p">(</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">        </span><span class="n">clk0</span><span class="p">,</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">        </span><span class="n">web0</span><span class="p">,</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">        </span><span class="n">csb0</span><span class="p">,</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">wmask0</span><span class="p">,</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">6</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">addr0</span><span class="p">,</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="w">  </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">din0</span><span class="p">,</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="w">  </span><span class="k">output</span><span class="w"> </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">dout0</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="p">);</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="w">  </span><span class="n">sram_SRAM_generic</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="w">  </span><span class="p">#(</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="w">    </span><span class="p">.</span><span class="n">p_data_nbits</span><span class="w">  </span><span class="p">(</span><span class="mh">32</span><span class="p">),</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="w">    </span><span class="p">.</span><span class="n">p_num_entries</span><span class="w"> </span><span class="p">(</span><span class="mh">128</span><span class="p">)</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a><span class="w">  </span><span class="p">)</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="w">  </span><span class="n">sram_generic</span>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a><span class="w">  </span><span class="p">(</span>
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="w">    </span><span class="p">.</span><span class="n">clk0</span><span class="w">   </span><span class="p">(</span><span class="n">clk0</span><span class="p">),</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a><span class="w">    </span><span class="p">.</span><span class="n">web0</span><span class="w">   </span><span class="p">(</span><span class="n">web0</span><span class="p">),</span>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a><span class="w">    </span><span class="p">.</span><span class="n">csb0</span><span class="w">   </span><span class="p">(</span><span class="n">csb0</span><span class="p">),</span>
</span><span id="__span-21-29"><a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="w">    </span><span class="p">.</span><span class="n">wmask0</span><span class="w"> </span><span class="p">(</span><span class="n">wmask0</span><span class="p">),</span>
</span><span id="__span-21-30"><a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="w">    </span><span class="p">.</span><span class="n">addr0</span><span class="w">  </span><span class="p">(</span><span class="n">addr0</span><span class="p">),</span>
</span><span id="__span-21-31"><a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a><span class="w">    </span><span class="p">.</span><span class="n">din0</span><span class="w">   </span><span class="p">(</span><span class="n">din0</span><span class="p">),</span>
</span><span id="__span-21-32"><a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a><span class="w">    </span><span class="p">.</span><span class="n">dout0</span><span class="w">  </span><span class="p">(</span><span class="n">dout0</span><span class="p">)</span>
</span><span id="__span-21-33"><a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a><span class="w">  </span><span class="p">);</span>
</span><span id="__span-21-34"><a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a>
</span><span id="__span-21-35"><a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a><span class="k">endmodule</span>
</span><span id="__span-21-36"><a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a>
</span><span id="__span-21-37"><a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a><span class="no">`endif</span><span class="w"> </span><span class="cm">/* SYNTHESIS */</span>
</span><span id="__span-21-38"><a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a>
</span><span id="__span-21-39"><a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a><span class="no">`endif</span><span class="w"> </span><span class="cm">/* SRAM_32x128_1rw */</span>
</span></code></pre></div>
<p>Notice how this is simply a wrapper around <code>sram_SRAM_generic</code>
instantiated with the desired number of words and bits per word.</p>
<p><strong>Step 4: Use new SRAM macro RTL model in top-level SRAM model</strong></p>
<p>The final step is to modify the top-level SRAM model to select the proper
SRAM macro RTL model. You will need to modify <code>SRAM.v</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/sram
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>%<span class="w"> </span>code<span class="w"> </span>SRAM.v
</span></code></pre></div>
<p>You need to add a new condition to the generate if statement as follows.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1">// Add this at the top of the file</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="no">`include</span><span class="w"> </span><span class="s">&quot;sram/SRAM_32x128_1rw.v&quot;</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="p">...</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">  </span><span class="k">generate</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">    </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="w"> </span><span class="n">p_data_nbits</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">32</span><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p_num_entries</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">256</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">SRAM_32x256_1rw</span><span class="w">  </span><span class="n">sram</span><span class="w"> </span><span class="p">(.</span><span class="o">*</span><span class="p">);</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">p_data_nbits</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">128</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p_num_entries</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">256</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">SRAM_128x256_1rw</span><span class="w"> </span><span class="n">sram</span><span class="w"> </span><span class="p">(.</span><span class="o">*</span><span class="p">);</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">    </span><span class="c1">// Add the following to choose a new SRAM configuration RTL model</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">p_data_nbits</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">32</span><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p_num_entries</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">128</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">SRAM_32x128_1rw</span><span class="w">  </span><span class="n">sram</span><span class="w"> </span><span class="p">(.</span><span class="o">*</span><span class="p">);</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">      </span><span class="n">sram_SRAM_generic</span><span class="p">#(</span><span class="n">p_data_nbits</span><span class="p">,</span><span class="n">p_num_entries</span><span class="p">)</span><span class="w"> </span><span class="n">sram</span><span class="w"> </span><span class="p">(.</span><span class="o">*</span><span class="p">);</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">  </span><span class="k">endgenerate</span>
</span></code></pre></div>
<p>One might ask what is the point of going through all of the trouble of
creating an SRAM macro RTL model that is for a specific size if we
already have a SRAM generic RTL model. The key reason is that the ASIC
flow will use the <em>name</em> of the SRAM to figure out where to swap in the
SRAM macro. So we need a explicit module name for every different SRAM
configuration to enable using SRAM macros in the ASIC flow.</p>
<p><strong>Step 5: Test new SRAM configuration</strong></p>
<p>The final step is to test the new configuration and verify everything
works. We start by adding a simple directed test to the <code>SRAM_test.py</code>
test script. Here is an example:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_direct_32x128</span><span class="p">(</span> <span class="n">cmdline_opts</span> <span class="p">):</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>  <span class="n">run_test_vector_sim</span><span class="p">(</span> <span class="n">SRAM</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="p">[</span> <span class="n">header_str</span><span class="p">,</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    <span class="c1"># val type idx  wben    wdata       rdata</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span> <span class="c1"># one at a time</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x00000000</span> <span class="p">],</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0xdeadbeef</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0xdeadbeef</span> <span class="p">],</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x01</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0xcafecafe</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x01</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0xcafecafe</span> <span class="p">],</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x1f</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x0a0a0a0a</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x1f</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x0a0a0a0a</span> <span class="p">],</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x1e</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x0b0b0b0b</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span> <span class="c1"># streaming reads</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x1e</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x1f</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x0b0b0b0b</span> <span class="p">],</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x01</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x0a0a0a0a</span> <span class="p">],</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0xcafecafe</span> <span class="p">],</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0xdeadbeef</span> <span class="p">],</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x1d</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x0c0c0c0c</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span> <span class="c1"># streaming writes/reads</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x1d</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x1c</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x0d0d0d0d</span><span class="p">,</span> <span class="mh">0x0c0c0c0c</span> <span class="p">],</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x1c</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x1b</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x0e0e0e0e</span><span class="p">,</span> <span class="mh">0x0d0d0d0d</span> <span class="p">],</span>
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x1b</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x0e0e0e0e</span> <span class="p">],</span>
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a>
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span> <span class="c1"># partial writes</span>
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x01</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x0f</span><span class="p">,</span> <span class="mb">0b1111</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b0001</span><span class="p">,</span> <span class="mh">0xdeadbeef</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-36"><a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b0000</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-37"><a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b0000</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x000000ef</span> <span class="p">],</span>
</span><span id="__span-24-38"><a id="__codelineno-24-38" name="__codelineno-24-38" href="#__codelineno-24-38"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x01</span><span class="p">,</span> <span class="mb">0b0100</span><span class="p">,</span> <span class="mh">0xcafecafe</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-39"><a id="__codelineno-24-39" name="__codelineno-24-39" href="#__codelineno-24-39"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x01</span><span class="p">,</span> <span class="mb">0b0000</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-40"><a id="__codelineno-24-40" name="__codelineno-24-40" href="#__codelineno-24-40"></a>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b0000</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x00fe0000</span> <span class="p">],</span>
</span><span id="__span-24-41"><a id="__codelineno-24-41" name="__codelineno-24-41" href="#__codelineno-24-41"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mh">0x0f</span><span class="p">,</span> <span class="mb">0b0000</span><span class="p">,</span> <span class="mh">0x0a0a0a0a</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-42"><a id="__codelineno-24-42" name="__codelineno-24-42" href="#__codelineno-24-42"></a>    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x0f</span><span class="p">,</span> <span class="mb">0b0000</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span>        <span class="p">],</span>
</span><span id="__span-24-43"><a id="__codelineno-24-43" name="__codelineno-24-43" href="#__codelineno-24-43"></a>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mh">0x00</span><span class="p">,</span> <span class="mb">0b0000</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x00000000</span> <span class="p">],</span>
</span><span id="__span-24-44"><a id="__codelineno-24-44" name="__codelineno-24-44" href="#__codelineno-24-44"></a>  <span class="p">],</span> <span class="n">cmdline_opts</span> <span class="p">)</span>
</span></code></pre></div>
<p>This directed test writes a value to a specific word and then reads that
word to verify the value was written correctly. We test writing the first
word, the last word, and other words. We also test using the write byte
enables for partial writes. We can run the directed test like this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/build
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>%<span class="w"> </span>pytest<span class="w"> </span>../sram/test/SRAM_test.py<span class="w"> </span>-k<span class="w"> </span>test_direct_32x128
</span></code></pre></div>
<p>We have included a helper function that simplifies random testing. All
you need to do is add the configuration to the <code>sram_configs</code> variable in
the test script like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>sram_configs = [ (16, 32), (32, 256), (128, 256), (32, 128) ]
</span></code></pre></div>
<p>Then you can run the random test like this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/build
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>%<span class="w"> </span>pytest<span class="w"> </span>../sram/test/SRAM_test.py<span class="w"> </span>-k<span class="w"> </span>test_random<span class="o">[</span><span class="m">32</span>-128<span class="o">]</span>
</span></code></pre></div>
<p>And of course we should run all of the tests to ensure we haven't broken
anything when adding this new configuration.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/build
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>%<span class="w"> </span>pytest<span class="w"> </span>../sram
</span></code></pre></div>
<h2 id="3-sram-minion-wrapper-rtl">3. SRAM Minion Wrapper RTL</h2>
<p>SRAMs use a latency <em>sensitive</em> interface meaning a user must carefully
manage the timing for correct operation (i.e., set the read address and
then exactly one cycle later use the read data). In addition, the SRAM
cannot be "stalled". To illustrate how to use SRAM macros, we will create
a latency <em>insensitive</em> val/rdy wrapper around an SRAM which enables
writing and reading the SRAM using our standard memory messages. The
following figure illustrates a naive approach to implementing the SRAM
val/rdy wrapper.</p>
<p><img alt="" src="../img/tut10-sram-valrdy-wrapper-uarch1.png" /></p>
<p>Consider what might happen if we use a single-element bypass queue. The
following pipeline diagram illustrates what can go wrong.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a> cycle : 0  1  2  3  4  5  6  7  8
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a> msg a : M0 Mx
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a> msg b :    M0 Mx
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a> msg c :       M0 M1 M2 M2 M2       # M2 stalls on cycles 3-5
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a> msg d :          M0 M1 M1 M1 M2    # but wait, we cannot stall in M1!
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a> msg e :             M0 M0 M0 M0 Mx
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a> cycle M0 M1 [q] M2
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>    0: a
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>    1: b  a      a  # a flows through bypass queue
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>    2: c  b      b  # b flows through bypass queue
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>    3: d  c         # M2 is stalled, c will need to go into bypq
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>    4: e  d   c     # q is full at beginning of cycle, enq_rdy = 0
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>    5: e  ?   c     # what happens to d? cannot stall in M1!
</span></code></pre></div>
<p>Here we are using Mx to indicate when a transaction goes through M1 and
M2 in the same cycle because it flows straight through the bypass queue.
So on cycle 3, the response interface is stalled and as a consequence
message c must be enqueued into the memory response queue. On cycle 4,
the response queue is full (<code>enq_rdy</code> = 0) so <code>memreq_rdy</code> = 0 and
message e will stall in M0 (i.e., will stall waiting to be accepted by
the SRAM wrapper). The critical question is what happens to message d? It
<em>cannot</em> stall in M1 because we cannot stall the SRAM. So basically we
just drop it. Increasing the amount of the buffering in the bypass queue
will not solve the problem. The key issue is that by the time we realize
the bypass queue is full we can potentially already have a transaction
executing in the SRAM, and this transaction cannot be stalled.</p>
<p>This is a classic situation where the need more skid buffering. A correct
solution will have two or more elements of buffering in the memory
response queue <em>and</em> stall M0 if there are less than two free elements in
the queue. Thus in the worst case, if M2 stalls we have room for two
messages in the response queue: the message currently in M1 and the
message currently in M0. Here is the updated design:</p>
<p><img alt="" src="../img/tut10-sram-valrdy-wrapper-uarch2.png" /></p>
<p>Here is the updated pipeline diagram.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a> cycle : 0  1  2  3  4  5  6  7  8
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a> msg a : M0 Mx
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a> msg b :    M0 Mx
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a> msg c :       M0 M1 M2 M2 M2
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a> msg d :          M0 M1 q  q  M2     # msg c is in skid buffer
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a> msg e :             M0 M0 M0 M0 Mx
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a> cycle M0 M1 [q ] M2
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>    0: a
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>    1: b  a       a  # a flows through bypass queue
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>    2: c  b       b  # b flows through bypass queue
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>    3: d  c          # M2 is stalled, c will need to go into bypq
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>    4: e  d    c     #
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>    5: e      dc     # d skids behind c into the bypq
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>    6: e       d  c  # c is dequeued from bypq
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>    7: e          d  # d is dequeued from bypq
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>    8:    e       e  # e flows through bypass queue
</span></code></pre></div>
<p>Note, with a pipe queue you still need two elements of buffering. There
could be a message in the response queue when M2 stalls and then you
still don't have anywhere to put the message currently in M1.</p>
<p>Take a closer look at the SRAM val/rdy wrapper we provide you.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/tut8_sram
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>%<span class="w"> </span>code<span class="w"> </span>SRAMMinion.v
</span></code></pre></div>
<p>Notice how we are instantiating the SRAM within the SRAM val/rdy wrapper.
We are using an SRAM corresponding to the newly created SRAM macro
configuration/RTL from the previous section.</p>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="no">`include</span><span class="w"> </span><span class="s">&quot;sram/SRAM.v&quot;</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="p">...</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="n">sram_SRAM</span><span class="p">#(</span><span class="mh">32</span><span class="p">,</span><span class="mh">128</span><span class="p">)</span><span class="w"> </span><span class="n">sram</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="w"> </span><span class="p">(</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w">   </span><span class="p">.</span><span class="n">clk</span><span class="w">         </span><span class="p">(</span><span class="n">clk</span><span class="p">),</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="w">   </span><span class="p">.</span><span class="n">reset</span><span class="w">       </span><span class="p">(</span><span class="n">reset</span><span class="p">),</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="w">   </span><span class="p">.</span><span class="n">port0_idx</span><span class="w">   </span><span class="p">(</span><span class="n">sram_addr_M0</span><span class="p">),</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">   </span><span class="p">.</span><span class="n">port0_type</span><span class="w">  </span><span class="p">(</span><span class="n">sram_wen_M0</span><span class="p">),</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="w">   </span><span class="p">.</span><span class="n">port0_val</span><span class="w">   </span><span class="p">(</span><span class="n">sram_en_M0</span><span class="p">),</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="w">   </span><span class="p">.</span><span class="n">port0_wben</span><span class="w">  </span><span class="p">(</span><span class="n">sram_wben_M0</span><span class="p">),</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="w">   </span><span class="p">.</span><span class="n">port0_wdata</span><span class="w"> </span><span class="p">(</span><span class="n">memreq_msg_data_M0</span><span class="p">),</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="w">   </span><span class="p">.</span><span class="n">port0_rdata</span><span class="w"> </span><span class="p">(</span><span class="n">sram_read_data_M1</span><span class="p">)</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="w"> </span><span class="p">);</span>
</span></code></pre></div>
<p>To use an SRAM, simply import <code>sram/SRAM.v</code>, instantiate the SRAM, and
set the number of words and number of bits per word. We can run a test on
the SRAM val/rdy wrapper like this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>%<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$TOPDIR</span>/sim/build
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/build
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>%<span class="w"> </span>pytest<span class="w"> </span>../tut10_sram/test/SRAMMinion_test.py<span class="w"> </span>-k<span class="w"> </span>random_0_3<span class="w"> </span>-s
</span></code></pre></div>
<p>The trace output should look like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a> ...
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>  3:                           &gt; (  (). ) &gt; .
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>  4: wr:00:00000000:0:55fceed9 &gt; (wr(). ) &gt; .
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>  5: wr:01:00000004:0:5bec8a7b &gt; (wr()# ) &gt; #
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>  6: #                         &gt; (# ()# ) &gt; #
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>  7: #                         &gt; (# ()wr) &gt; wr:00:0:0:
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>  8: #                         &gt; (# ()# ) &gt; #
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>  9: #                         &gt; (# ()# ) &gt; #
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a> 10: #                         &gt; (# ()# ) &gt; #
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a> 11: #                         &gt; (# ()wr) &gt; wr:01:0:0:
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a> 12: wr:02:00000008:0:b1aa20f1 &gt; (wr(). ) &gt; .
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a> 13: wr:03:0000000c:0:a5b6b6bb &gt; (wr()# ) &gt; #
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a> 14: #                         &gt; (# ()# ) &gt; #
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a> 15: #                         &gt; (# ()wr) &gt; wr:02:0:0:
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a> 16: #                         &gt; (# ()# ) &gt; #
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a> 17: #                         &gt; (# ()# ) &gt; #
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a> 18: #                         &gt; (# ()# ) &gt; #
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a> 19: #                         &gt; (# ()wr) &gt; wr:03:0:0:
</span></code></pre></div>
<p>The first write transaction takes a single cycle to go through the SRAM
val/rdy wrapper (and is held up in the SRAM), but the SRAM response
interface is not ready on cycles 5-6. The second write transaction is
still accepted by the SRAM val/rdy wrapper and will end up in the bypass
queue, but the third write transaction is stalled because the request
interface is not ready. No transactions are lost.</p>
<p>Let's now rerun the tests and run the interactive simulator to create the
Verilog test benches which we can use for four-state RTL, fast-functional
gate-level, and back-annotated gate-level simulation.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/build
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>%<span class="w"> </span>pytest<span class="w"> </span>../tut10_sram/test/SRAMMinion_test.py<span class="w"> </span>--test-verilog<span class="w"> </span>--dump-vtb
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>%<span class="w"> </span>../tut10_sram/sram-sim<span class="w"> </span>--impl<span class="w"> </span>rtl<span class="w"> </span>--input<span class="w"> </span>random<span class="w"> </span>--translate<span class="w"> </span>--dump-vtb
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>%<span class="w"> </span>ls
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>...
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>SRAMMinion_noparam__pickled.v
</span></code></pre></div>
<p>As you can see, the simulator will generate a Verilog file
<code>SRAMMinion_noparam__pickled.v</code> which is what we use with the ASIC
tools.</p>
<h2 id="4-asic-front-end-flow-with-sram-macros">4. ASIC Front-End Flow with SRAM Macros</h2>
<p>Now we will push our SRAM minion wrapper through the ASIC front-end flow.
In this section, we will go through the steps manually. Later in the
tutorial we will use the ASIC automated flow.</p>
<h3 id="41-sram-generation">4.1. SRAM Generation</h3>
<p>The first step is to run the OpenRAM memory generator to generate the
SRAM macro corresponding to the desired 32x128 configuration.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>%<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/00-openram-memgen
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/00-openram-memgen
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>%<span class="w"> </span>openram<span class="w"> </span>-v<span class="w"> </span>-v<span class="w"> </span>../../../sim/sram/SRAM_32x128_1rw_cfg.py
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>SRAM_32x128_1rw
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>%<span class="w"> </span>cp<span class="w"> </span>SRAM_32x128_1rw_TT_1p1V_25C.lib<span class="w"> </span>../SRAM_32x128_1rw.lib
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>%<span class="w"> </span>cp<span class="w"> </span>*.gds<span class="w"> </span>*.lef<span class="w"> </span>*.v<span class="w"> </span>..
</span></code></pre></div>
<p>We need to convert the <code>.lib</code> file into a <code>.db</code> file using the Synopsys
Library Compiler (LC) tool.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>% cd $TOPDIR/asic/build-tut10-sram/00-openram-memgen
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>% lc_shell
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>lc_shell&gt; read_lib SRAM_32x128_1rw.lib
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>lc_shell&gt; write_lib SRAM_32x128_1rw_TT_1p1V_25C_lib \
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>  -format db -output SRAM_32x128_1rw.db
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>lc_shell&gt; exit
</span></code></pre></div>
<p>Check that the <code>.db</code> file now exists.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/00-openram-memgen
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>%<span class="w"> </span>ls
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>...
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>SRAM_32x128_1rw.db
</span></code></pre></div>
<h3 id="42-four-state-rtl-simulation">4.2. Four-State RTL Simulation</h3>
<p>We now need to use four-state RTL simulation to further verify our
design.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>%<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="si">${</span><span class="nv">TOPDIR</span><span class="si">}</span>/asic/build-tut10-sram/01-synopsys-vcs-rtlsim
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">TOPDIR</span><span class="si">}</span>/asic/build-tut10-sram/01-synopsys-vcs-rtlsim
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>%<span class="w"> </span>vcs<span class="w"> </span>-sverilog<span class="w"> </span>-xprop<span class="o">=</span>tmerge<span class="w"> </span>-override_timescale<span class="o">=</span>1ns/1ps<span class="w"> </span>-top<span class="w"> </span>Top<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">    </span>+vcs+dumpvars+waves.vcd<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">    </span>+incdir+<span class="si">${</span><span class="nv">TOPDIR</span><span class="si">}</span>/sim/build<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">    </span><span class="si">${</span><span class="nv">TOPDIR</span><span class="si">}</span>/sim/build/SRAMMinion_noparam__pickled.v<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="w">    </span><span class="si">${</span><span class="nv">TOPDIR</span><span class="si">}</span>/sim/build/SRAMMinion_noparam_sram-rtl-random_tb.v
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>%<span class="w"> </span>./simv
</span></code></pre></div>
<h3 id="43-synthesis">4.3. Synthesis</h3>
<p>Now we can use Synopsys DC to synthesize the logic which goes around the
SRAM macro.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>% mkdir -p $TOPDIR/asic/build-tut10-sram/02-synopsys-dc-synth
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>% cd $TOPDIR/asic/build-tut10-sram/02-synopsys-dc-synth
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>% dc_shell-xg-t
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>dc_shell&gt; set_app_var target_library &quot;$env(ECE6745_STDCELLS)/stdcells.db ../00-openram-memgen/SRAM_32x128_1rw.db&quot;
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>dc_shell&gt; set_app_var link_library   &quot;* $env(ECE6745_STDCELLS)/stdcells.db ../00-openram-memgen/SRAM_32x128_1rw.db&quot;
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>dc_shell&gt; analyze -format sverilog ../../../sim/build/SRAMMinion_noparam__pickled.v
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>dc_shell&gt; elaborate SRAMMinion_noparam
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>dc_shell&gt; create_clock clk -name ideal_clock1 -period 2.0
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>dc_shell&gt; compile
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>dc_shell&gt; write -format ddc     -hierarchy -output post-synth.ddc
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a>dc_shell&gt; write -format verilog -hierarchy -output post-synth.v
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>dc_shell&gt; write_sdc post-synth.sdc
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a>dc_shell&gt; report_area   -hierarchy
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a>dc_shell&gt; report_timing -nets
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a>dc_shell&gt; exit
</span></code></pre></div>
<p>We are basically using the same steps we used in the Synopsys/Cadence
ASIC tool tutorial. Notice how we must point Synopsys DC to the <code>.db</code>
file generated by OpenRAM so Synopsys DC knows the abstract logical,
timing, power view of the SRAM.</p>
<p>If you look for the SRAM module in the synthesized gate-level netlist,
you will see that it is referenced but not declared. This is what we
expect since we are not synthesizing the memory but instead using an SRAM
macro.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/synopsys-dc
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>%<span class="w"> </span>less<span class="w"> </span>-p<span class="w"> </span>SRAM<span class="w"> </span>post-synth.v
</span></code></pre></div>
<h3 id="44-fast-functional-gate-level-simulation">4.4. Fast-Functional Gate-Level Simulation</h3>
<p>We can use fast-functional gate-level simulation to simulate the
gate-level netlist integrated with the Verilog RTL models for the SRAMs.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/03-synopsys-vcs-ffglsim
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>%<span class="w"> </span>vcs<span class="w"> </span>-sverilog<span class="w"> </span>-xprop<span class="o">=</span>tmerge<span class="w"> </span>-override_timescale<span class="o">=</span>1ns/1ps<span class="w"> </span>-top<span class="w"> </span>Top<span class="w"> </span><span class="se">\</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="w">    </span>+delay_mode_zero<span class="w"> </span><span class="se">\</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="w">    </span>+vcs+dumpvars+waves.vcd<span class="w"> </span><span class="se">\</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">    </span>+incdir+<span class="si">${</span><span class="nv">TOPDIR</span><span class="si">}</span>/sim/build<span class="w"> </span><span class="se">\</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">    </span><span class="si">${</span><span class="nv">ECE6745_STDCELLS</span><span class="si">}</span>/stdcells.v<span class="w"> </span><span class="se">\</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="w">    </span>../00-openram-memgen/SRAM_32x128_1rw.v<span class="w"> </span><span class="se">\</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="w">    </span>../02-synopsys-dc-synth/post-synth.v<span class="w"> </span><span class="se">\</span>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="w">    </span><span class="si">${</span><span class="nv">TOPDIR</span><span class="si">}</span>/sim/build/SRAMMinion_noparam_sram-rtl-random_tb.v
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>%<span class="w"> </span>./simv
</span></code></pre></div>
<p>Notice how we now need to provide the Verilog behavioral model for the
SRAM which will be simulated along with the gate-level implementation.</p>
<h2 id="5-asic-back-end-flow-with-sram-macros">5. ASIC Back-End Flow with SRAM Macros</h2>
<p>Now we will push our SRAM minion wrapper through the ASIC back-end flow.
In this section, we will go through the steps manually. Later in the
tutorial we will use the ASIC automated flow.</p>
<h3 id="51-place-and-route">5.1. Place and Route</h3>
<p>We use Cadence Innovus for placing and routing both the standard cells
and the SRAM macros. As in the ASIC back-end flow tutorial, we need to
create a file to setup the timing analysis.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>%<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/04-cadence-innovus-pnr
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/04-cadence-innovus-pnr
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>%<span class="w"> </span>code<span class="w"> </span>setup-timing.tcl
</span></code></pre></div>
<p>The file should have the following content:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>create_rc_corner -name typical \
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>   -cap_table &quot;$env(ECE6745_STDCELLS)/rtk-typical.captable&quot; \
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>   -T 25
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>create_library_set -name libs_typical \
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>   -timing [list &quot;$env(ECE6745_STDCELLS)/stdcells.lib&quot; \
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>                 &quot;../openram-mc/SRAM_32x128_1rw.lib&quot;]
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>create_delay_corner -name delay_default \
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>   -library_set libs_typical \
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a>   -rc_corner typical
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a>create_constraint_mode -name constraints_default \
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a>   -sdc_files [list ../02-synopsys-dc-synth/post-synth.sdc]
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>
</span><span id="__span-44-16"><a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a>create_analysis_view -name analysis_default \
</span><span id="__span-44-17"><a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a>   -constraint_mode constraints_default \
</span><span id="__span-44-18"><a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a>   -delay_corner delay_default
</span><span id="__span-44-19"><a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a>
</span><span id="__span-44-20"><a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a>set_analysis_view -setup analysis_default -hold  analysis_default
</span></code></pre></div>
<p>This is very similar to the <code>setup-timing.tcl</code> file we used in the ASIC
back-end flow tutorial, except that we have to include the <code>.lib</code> file
generated by OpenRAM.</p>
<p>Now let's start Cadence Innovus, load in the design, and complete the
power routing just as in the ASIC back-end tutorial.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>% cd $TOPDIR/asic/build-tut10-sram/04-cadence-innovus-pnr
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>% innovus
</span></code></pre></div>
<p>The initial setup is very similar to what we used in the ASIC back-end
flow tutorial.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>innovus&gt; set init_mmmc_file &quot;setup-timing.tcl&quot;
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>innovus&gt; set init_verilog   &quot;../02-synopsys-dc-synth/post-synth.v&quot;
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>innovus&gt; set init_top_cell  &quot;SRAMMinion_noparam&quot;
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>innovus&gt; set init_lef_file  &quot;$env(ECE6745_STDCELLS)/rtk-tech.lef \
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>                            $env(ECE6745_STDCELLS)/stdcells.lef \
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>                            ../00-openram-memgen/SRAM_32x128_1rw.lef&quot;
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>innovus&gt; set init_pwr_net   {VDD vdd}
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>innovus&gt; set init_gnd_net   {VSS gnd}
</span></code></pre></div>
<p>Two key differences from earlier tutorials are: (1) including the <code>.lef</code>
file generated by OpenRAM; and (2) including <code>vdd</code> and <code>gnd</code> which are
the names of the power nets used in OpenRAM.</p>
<p>We are now ready to use the <code>init_design</code> command to read in the verilog,
set the design name, setup the timing analysis views, read the technology
<code>.lef</code> for layer information, and read the standard cell <code>.lef</code> for
physical information about each cell and the SRAM used in the design.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>innovus&gt; init_design
</span></code></pre></div>
<p>We also need to tell Cadence Innovus some additional setup information
just like in the ASIC back-end flow tutorial.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>innovus&gt; setDesignMode -process 45
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>innovus&gt; setDelayCalMode -SIAware false
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>innovus&gt; setOptMode -usefulSkew false
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>innovus&gt; setOptMode -holdTargetSlack 0.010
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>innovus&gt; setOptMode -holdFixingCells {
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>           BUF_X1 BUF_X1 BUF_X2 BUF_X4 BUF_X8 BUF_X16 BUF_X32
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>         }
</span></code></pre></div>
<p>In the earlier tutorials, we used automatic floorplanning which
determines the overall dimensions given a target aspect ratio and
placement density. We used a target aspect ratio of 1.0 and a placement
density of 70%. Because the SRAM macro has an aspect ratio closer to 2:1
we will will need to use a different floorplan. So instead of using
automatic floorplanning, we will use a fixed floorplan which uses a
specific width and height.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>innovus&gt; floorPlan -d 175 175 4.0 4.0 4.0 4.0
</span></code></pre></div>
<p>From looking at the <code>.gds</code> file for the SRAM earlier in the tutorial, we
know that the SRAM is about 140um wide by 75um tall, so we set the height
and width of the floorplan to be 175um.</p>
<p><img alt="" src="../img/tut10-cadence-innovus-1.png" /></p>
<p>The next step is to place the design. We first need to add a "halo"
around all SRAM macros using the <code>addHaloToBlock</code> command. A halo is a
way to tell Cadence Innovus not to place any standard cells too close to
the SRAM macros. We specify a halo of 4.8um.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>innovus&gt; addHaloToBlock 4.8 4.8 4.8 4.8 -allMacro
</span></code></pre></div>
<p>Now we need to use extra commands to concurrently place the standard
cells and the SRAM macro at the same time. For best results, we would
need to create a representative power grid so Cadence Innovus can take
into account power distribution when automatically placing SRAM macros,
but to simplify our flow we can just specify 20% metal 1 power routing
density.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>innovus&gt; set_macro_place_constraint -pg_resource_model {metal1 0.2}
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>innovus&gt; place_design -concurrent_macros
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>innovus&gt; refine_macro_place
</span></code></pre></div>
<p>After these steps the macros will be placed in their final positions, but
the standard cells are likely not in legal positions. So we now do the
final optimized placement.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>innovus&gt; place_opt_design
</span></code></pre></div>
<p>After placing the design we want to automatically place tie hi/lo cells
and the IO pins around the perimeter of the floorplan.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>innovus&gt; addTieHiLo -cell &quot;LOGIC1_X1 LOGIC0_X1&quot;
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>innovus&gt; assignIoPins -pin *
</span></code></pre></div>
<p>You should be able to see the SRAM macro placed in the middle of the
floorplan with the standard cells implementing the pipeline registers,
queue, and control logic positioned above and below the SRAM macro.</p>
<p><img alt="" src="../img/tut10-cadence-innovus-2.png" /></p>
<p>In the following close, up the halo is shown in a salmon color. Some of
the standard cells placed above the SRAM macro outside the halo.</p>
<p><img alt="" src="../img/tut10-cadence-innovus-3.png" /></p>
<p>The next step is power routing. We need to connect the power/ground pins
of both the standard cells and the SRAM macro to the global power/ground
nets. We also need to make sure the tie hi/lo cells are connected to the
global power/ground nets.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>innovus&gt; globalNetConnect VDD -type pgpin -pin VDD -all -verbose
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>innovus&gt; globalNetConnect VSS -type pgpin -pin VSS -all -verbose
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>innovus&gt; globalNetConnect VDD -type pgpin -pin vdd -all -verbose
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>innovus&gt; globalNetConnect VSS -type pgpin -pin gnd -all -verbose
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>innovus&gt; globalNetConnect VDD -type tiehi -pin VDD -all -verbose
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>innovus&gt; globalNetConnect VSS -type tielo -pin VSS -all -verbose
</span></code></pre></div>
<p>Just as in the previous tutorials, we then route the M1 power rails for
the standard cells, create a power ring, and add horizontal/vertical
power stripes to create a power grid.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>innovus&gt; sroute -nets {VDD VSS}
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>innovus&gt; addRing \
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>           -nets {VDD VSS} -width 0.8 -spacing 0.8 \
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>           -layer [list top 9 bottom 9 left 8 right 8]
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>innovus&gt; addStripe \
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>           -nets {VSS VDD} -layer 9 -direction horizontal \
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>           -width 0.8 -spacing 4.8 \
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>           -set_to_set_distance 11.2 -start_offset 2.4
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a>innovus&gt; addStripe \
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a>           -nets {VSS VDD} -layer 8 -direction vertical \
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a>           -width 0.8 -spacing 4.8 \
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a>           -set_to_set_distance 11.2 -start_offset 2.4
</span></code></pre></div>
<p><img alt="" src="../img/tut10-cadence-innovus-4.png" /></p>
<p>In the following close up, we have hidden the halo so we can clearly see
how the power routing stops the M1 power rails from going through the
SRAM macro. You can also see the horizontal VDD and VSS power stripes
have vias that connect to the SRAM macro power/ground pins (i.e., connect
to the power ring which is inside the SRAM macro).</p>
<p><img alt="" src="../img/tut10-cadence-innovus-5.png" /></p>
<p>The next step is to route the clock tree and do an initial round of
fixing setup-time and hold-time violations.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>innovus&gt; create_ccopt_clock_tree_spec
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>innovus&gt; set_ccopt_property update_io_latency false
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>innovus&gt; ccopt_design -cts
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>innovus&gt; optDesign -postCTS -setup
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>innovus&gt; optDesign -postCTS -hold
</span></code></pre></div>
<p><img alt="" src="../img/tut10-cadence-innovus-6.png" /></p>
<p>The next step is to route the signals, do a final round of fixing
setup-time and hold-time violations, and extract the interconnect RC
parasitics.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>innovus&gt; routeDesign
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>innovus&gt; optDesign -postRoute -setup
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>innovus&gt; optDesign -postRoute -hold
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>innovus&gt; extractRC
</span></code></pre></div>
<p>In the following close-up, we can see how Cadence Innovus has routed from
the standard-cells to the pins on the SRAM macro, but we can also see how
Cadence Innovus has routed some nets over top of the SRAM macro on M5.
Cadence Innovus will not route any signals on M1, M2, M3, or M4 over the
SRAM macro since the SRAM uses these metal layers for internal routing.
Cadence Innovus knows to not use these metal layers by looking at the
routing blockages in the SRAM macro's <code>.lef</code> file.</p>
<p><img alt="" src="../img/tut10-cadence-innovus-7.png" /></p>
<p>We can now finish up by adding filler cells and running some physical
verification checks.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>innovus&gt; setFillerMode -core {FILLCELL_X4 FILLCELL_X2 FILLCELL_X1}
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>innovus&gt; addFiller
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>innovus&gt; verifyConnectivity
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>innovus&gt; verify_drc
</span></code></pre></div>
<p>As in previous tutorials, we output the design, gate-level netlist,
interconnect parasitics, timing delays, and the final layout. Notice how
we have to include the <code>.gds</code> file for the SRAM macro so it can be merged
into the final <code>.gds</code> file.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>innovus&gt; saveDesign post-pnr.enc
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>innovus&gt; saveNetlist post-pnr.v
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>innovus&gt; rcOut -rc_corner typical -spef post-pnr.spef
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>innovus&gt; write_sdf post-pnr.sdf
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>innovus&gt; streamOut post-pnr.gds \
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a>           -merge &quot;$env(ECE6745_STDCELLS)/stdcells.gds \
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a>                   ../00-openram-memgen/SRAM_32x128_1rw.gds&quot; \
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a>           -mapFile &quot;$env(ECE6745_STDCELLS)/rtk-stream-out.map&quot;
</span></code></pre></div>
<p>We can generate a timing report for the setup-time constraint.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>innovus&gt; report_timing -late -path_type full_clock -net
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>...
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>Other End Arrival Time          0.000
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>- External Delay                0.050
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>+ Phase Shift                   2.000
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>= Required Time                 1.950
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>- Arrival Time                  1.582
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>= Slack Time                    0.368
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a>     Clock Fall Edge                      1.000
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>     = Beginpoint Arrival Time            1.000
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>     +-----------------------------------------------------------------------------------------------------------------------------------+
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a>     |                        Pin             | Edge |               Net               |        Cell        | Delay | Arrival | Required |
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a>     |                                        |      |                                 |                    |       |  Time   |   Time   |
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>     |----------------------------------------+------+---------------------------------+--------------------+-------+---------+----------|
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15" href="#__codelineno-60-15"></a>     | clk[0]                                 |  v   | clk[0]                          |                    |       |   1.000 |    1.368 |
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16" href="#__codelineno-60-16"></a>     | v/CTS_ccl_a_buf_00002/A                |  v   | clk[0]                          | CLKBUF_X3          | 0.001 |   1.001 |    1.369 |
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17" href="#__codelineno-60-17"></a>     | v/CTS_ccl_a_buf_00002/Z                |  v   | v/CTS_2                         | CLKBUF_X3          | 0.036 |   1.037 |    1.405 |
</span><span id="__span-60-18"><a id="__codelineno-60-18" name="__codelineno-60-18" href="#__codelineno-60-18"></a>     | v/sram/genblk1.sram/clk0               |  v   | v/CTS_2                         | SRAM_32x128_1rw    | 0.001 |   1.038 |    1.406 |
</span><span id="__span-60-19"><a id="__codelineno-60-19" name="__codelineno-60-19" href="#__codelineno-60-19"></a>     | v/sram/genblk1.sram/dout0[29]          |  v   | v/sram_read_data_M1[29]         | SRAM_32x128_1rw    | 0.294 |   1.333 |    1.700 |
</span><span id="__span-60-20"><a id="__codelineno-60-20" name="__codelineno-60-20" href="#__codelineno-60-20"></a>     | v/FE_PDC58_sram_read_data_M1_29/A      |  v   | v/sram_read_data_M1[29]         | BUF_X1             | 0.000 |   1.333 |    1.700 |
</span><span id="__span-60-21"><a id="__codelineno-60-21" name="__codelineno-60-21" href="#__codelineno-60-21"></a>     | v/FE_PDC58_sram_read_data_M1_29/Z      |  v   | v/FE_PDN58_sram_read_data_M1_29 | BUF_X1             | 0.022 |   1.354 |    1.722 |
</span><span id="__span-60-22"><a id="__codelineno-60-22" name="__codelineno-60-22" href="#__codelineno-60-22"></a>     | v/FE_OFC34_sram_read_data_M1_29/A      |  v   | v/FE_PDN58_sram_read_data_M1_29 | CLKBUF_X1          | 0.000 |   1.354 |    1.722 |
</span><span id="__span-60-23"><a id="__codelineno-60-23" name="__codelineno-60-23" href="#__codelineno-60-23"></a>     | v/FE_OFC34_sram_read_data_M1_29/Z      |  v   | v/FE_OFN34_sram_read_data_M1_29 | CLKBUF_X1          | 0.030 |   1.385 |    1.752 |
</span><span id="__span-60-24"><a id="__codelineno-60-24" name="__codelineno-60-24" href="#__codelineno-60-24"></a>     | v/FE_OFC3_sram_read_data_M1_29/A       |  v   | v/FE_OFN34_sram_read_data_M1_29 | CLKBUF_X1          | 0.000 |   1.385 |    1.753 |
</span><span id="__span-60-25"><a id="__codelineno-60-25" name="__codelineno-60-25" href="#__codelineno-60-25"></a>     | v/FE_OFC3_sram_read_data_M1_29/Z       |  v   | v/FE_OFN3_sram_read_data_M1_29  | CLKBUF_X1          | 0.049 |   1.434 |    1.801 |
</span><span id="__span-60-26"><a id="__codelineno-60-26" name="__codelineno-60-26" href="#__codelineno-60-26"></a>     | v/U66/A1                               |  v   | v/FE_OFN3_sram_read_data_M1_29  | AND2_X1            | 0.002 |   1.436 |    1.803 |
</span><span id="__span-60-27"><a id="__codelineno-60-27" name="__codelineno-60-27" href="#__codelineno-60-27"></a>     | v/U66/ZN                               |  v   | v/memresp_msg_M1[data][29]      | AND2_X1            | 0.045 |   1.481 |    1.849 |
</span><span id="__span-60-28"><a id="__codelineno-60-28" name="__codelineno-60-28" href="#__codelineno-60-28"></a>     | v/memresp_queue/dpath/bypass_mux/U30/A |  v   | v/memresp_msg_M1[data][29]      | MUX2_X1            | 0.001 |   1.482 |    1.849 |
</span><span id="__span-60-29"><a id="__codelineno-60-29" name="__codelineno-60-29" href="#__codelineno-60-29"></a>     | v/memresp_queue/dpath/bypass_mux/U30/Z |  v   | v/minion_resp_msg_raw[data][29] | MUX2_X1            | 0.057 |   1.539 |    1.906 |
</span><span id="__span-60-30"><a id="__codelineno-60-30" name="__codelineno-60-30" href="#__codelineno-60-30"></a>     | v/U34/A2                               |  v   | v/minion_resp_msg_raw[data][29] | AND2_X1            | 0.000 |   1.539 |    1.906 |
</span><span id="__span-60-31"><a id="__codelineno-60-31" name="__codelineno-60-31" href="#__codelineno-60-31"></a>     | v/U34/ZN                               |  v   | minion_respstream_msg[29]       | AND2_X1            | 0.043 |   1.582 |    1.950 |
</span><span id="__span-60-32"><a id="__codelineno-60-32" name="__codelineno-60-32" href="#__codelineno-60-32"></a>     | minion_respstream_msg[29]              |  v   | minion_respstream_msg[29]       | SRAMMinion_noparam | 0.000 |   1.582 |    1.950 |
</span><span id="__span-60-33"><a id="__codelineno-60-33" name="__codelineno-60-33" href="#__codelineno-60-33"></a>     +-----------------------------------------------------------------------------------------------------------------------------------+
</span></code></pre></div>
<p>Here we can see the SRAM macro is on the critical path. The clock
constraint is 2ns. The negative edge of the clock is used to trigger the
read data, so the path has an initial 1ns arrival time. This means the
clock-to-data path must be less than 1ns. We can see it takes
approximately 38ps for the top-level clock pin to reach the clock pin on
the SRAM macro and then the actual SRAM read requires 294ps which matches
what we saw in the <code>.lib</code> file earlier in the tutorial. It takes 249ps
for the data to travel from the SRAM read data ports to the top-level
response message pin. The critical path takes 582ps which is less than
the required 1ns so we meet the setup time constraint.</p>
<p>We can also generate a timing report for the hold-time constraint.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>innovus&gt; report_timing -early -path_type full_clock -net
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>...
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>Other End Arrival Time          0.037
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a>+ Hold                          0.001
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a>+ Phase Shift                   0.000
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a>= Required Time                 0.038
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a>  Arrival Time                  0.048
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a>  Slack Time                    0.010
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>     Clock Rise Edge                      0.000
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a>     + Input Delay                        0.000
</span><span id="__span-61-11"><a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a>     = Beginpoint Arrival Time            0.000
</span><span id="__span-61-12"><a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a>     Timing Path:
</span><span id="__span-61-13"><a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a>     +---------------------------------------------------------------------------------------------------------------------------+
</span><span id="__span-61-14"><a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a>     |                Pin                | Edge |               Net               |      Cell       | Delay | Arrival | Required |
</span><span id="__span-61-15"><a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a>     |                                   |      |                                 |                 |       |  Time   |   Time   |
</span><span id="__span-61-16"><a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a>     |-----------------------------------+------+---------------------------------+-----------------+-------+---------+----------|
</span><span id="__span-61-17"><a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a>     | minion_reqstream_msg[3]           |  ^   | minion_reqstream_msg[3]         |                 |       |   0.000 |   -0.010 |
</span><span id="__span-61-18"><a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a>     | FE_PHC87_minion_reqstream_msg_3/A |  ^   | minion_reqstream_msg[3]         | BUF_X1          | 0.000 |   0.000 |   -0.010 |
</span><span id="__span-61-19"><a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a>     | FE_PHC87_minion_reqstream_msg_3/Z |  ^   | FE_PHN87_minion_reqstream_msg_3 | BUF_X1          | 0.018 |   0.018 |    0.007 |
</span><span id="__span-61-20"><a id="__codelineno-61-20" name="__codelineno-61-20" href="#__codelineno-61-20"></a>     | FE_PHC50_minion_reqstream_msg_3/A |  ^   | FE_PHN87_minion_reqstream_msg_3 | BUF_X1          | 0.000 |   0.018 |    0.007 |
</span><span id="__span-61-21"><a id="__codelineno-61-21" name="__codelineno-61-21" href="#__codelineno-61-21"></a>     | FE_PHC50_minion_reqstream_msg_3/Z |  ^   | FE_PHN50_minion_reqstream_msg_3 | BUF_X1          | 0.030 |   0.048 |    0.037 |
</span><span id="__span-61-22"><a id="__codelineno-61-22" name="__codelineno-61-22" href="#__codelineno-61-22"></a>     | v/sram/genblk1.sram/din0[3]       |  ^   | FE_PHN50_minion_reqstream_msg_3 | SRAM_32x128_1rw | 0.000 |   0.048 |    0.038 |
</span><span id="__span-61-23"><a id="__codelineno-61-23" name="__codelineno-61-23" href="#__codelineno-61-23"></a>     +---------------------------------------------------------------------------------------------------------------------------+
</span><span id="__span-61-24"><a id="__codelineno-61-24" name="__codelineno-61-24" href="#__codelineno-61-24"></a>     Clock Rise Edge                      0.000
</span><span id="__span-61-25"><a id="__codelineno-61-25" name="__codelineno-61-25" href="#__codelineno-61-25"></a>     = Beginpoint Arrival Time            0.000
</span><span id="__span-61-26"><a id="__codelineno-61-26" name="__codelineno-61-26" href="#__codelineno-61-26"></a>     Other End Path:
</span><span id="__span-61-27"><a id="__codelineno-61-27" name="__codelineno-61-27" href="#__codelineno-61-27"></a>     +------------------------------------------------------------------------------------------+
</span><span id="__span-61-28"><a id="__codelineno-61-28" name="__codelineno-61-28" href="#__codelineno-61-28"></a>     |           Pin            | Edge |   Net   |      Cell       | Delay | Arrival | Required |
</span><span id="__span-61-29"><a id="__codelineno-61-29" name="__codelineno-61-29" href="#__codelineno-61-29"></a>     |                          |      |         |                 |       |  Time   |   Time   |
</span><span id="__span-61-30"><a id="__codelineno-61-30" name="__codelineno-61-30" href="#__codelineno-61-30"></a>     |--------------------------+------+---------+-----------------+-------+---------+----------|
</span><span id="__span-61-31"><a id="__codelineno-61-31" name="__codelineno-61-31" href="#__codelineno-61-31"></a>     | clk[0]                   |  ^   | clk[0]  |                 |       |   0.000 |    0.010 |
</span><span id="__span-61-32"><a id="__codelineno-61-32" name="__codelineno-61-32" href="#__codelineno-61-32"></a>     | v/CTS_ccl_a_buf_00002/A  |  ^   | clk[0]  | CLKBUF_X3       | 0.001 |   0.001 |    0.011 |
</span><span id="__span-61-33"><a id="__codelineno-61-33" name="__codelineno-61-33" href="#__codelineno-61-33"></a>     | v/CTS_ccl_a_buf_00002/Z  |  ^   | v/CTS_2 | CLKBUF_X3       | 0.035 |   0.036 |    0.046 |
</span><span id="__span-61-34"><a id="__codelineno-61-34" name="__codelineno-61-34" href="#__codelineno-61-34"></a>     | v/sram/genblk1.sram/clk0 |  ^   | v/CTS_2 | SRAM_32x128_1rw | 0.001 |   0.037 |    0.047 |
</span><span id="__span-61-35"><a id="__codelineno-61-35" name="__codelineno-61-35" href="#__codelineno-61-35"></a>     +------------------------------------------------------------------------------------------+
</span></code></pre></div>
<p>Here we can see that Cadence Innovus has inserted buffers from the
top-level input pins to the pipeline register to ensure this path meets
the hold-time constraint of 1ps for the SRAM macro. The delay from the
top-level clock pin to the clock pin on the pipeline register is 37ps and
the delay from the top-level input pin to the data pin of the SRAM macro
is 48ps. Since 48ps - 37ps = 11ps this path just meets the hold-time
constraint of 1ps with 10ps of slack which was the target.</p>
<p>We can report the area as well.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>innovus&gt; report_area
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>Hinst Name                            Module Name      Inst Count     Area
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>--------------------------------------------------------------------------
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>SRAMMinion_noparam                                            539  11675.5
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a> v                                    tut10_sram_SRAMMinion   424  11584.8
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>  v/memresp_queue                     vc_Queue_2_48_2         209    627.2
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>   v/memresp_queue/ctrl               vc_QueueCtrl_2_2         22     33.7
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>    v/memresp_queue/ctrl/deq_ptr_reg  vc_ResetReg_p_nbits1_1    3      6.3
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>    v/memresp_queue/ctrl/enq_ptr_reg  vc_ResetReg_p_nbits1_2    3      5.8
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a>    v/memresp_queue/ctrl/full_reg     vc_ResetReg_p_nbits1_0    5      7.4
</span><span id="__span-62-11"><a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a>   v/memresp_queue/dpath              vc_QueueDpath_2_48_2    187    593.4
</span><span id="__span-62-12"><a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a>    v/memresp_queue/dpath/bypass_mux  vc_Mux2_p_nbits48        45     83.7
</span><span id="__span-62-13"><a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a>    v/memresp_queue/dpath/qstore      vc_Regfile_1r1w         142    509.6
</span><span id="__span-62-14"><a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a>  v/sram                              sram_SRAM                38  10740.8
</span></code></pre></div>
<p>As expected over 90% of the area is in the SRAM with less than 10% in the
pipeline registers, queues, and control logic.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>innovus&gt; exit
</span></code></pre></div>
<p>And now we can use Klayout to look at the final integrated layout.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>% cd $TOPDIR/asic/build-tut10-sram/04-cadence-innovus-pnr
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>% klayout -l $ECE6745_STDCELLS/klayout.lyp post-pnr.gds
</span></code></pre></div>
<p><img alt="" src="../img/tut10-final-layout-1.png" /></p>
<p>In the following close-up we can see the SRAM bitcell array in the upper
right-hand corner along with the SRAM address decoder and SRAM column
muxing and sense amps. We can see a row of flip-flops which are part of
the SRAM macro and at the bottom we can see a few of the standard cells
used for the response queue where they connect to the data pins of the
SRAM macro.</p>
<p><img alt="" src="../img/tut10-final-layout-2.png" /></p>
<h3 id="52-back-annotated-gate-level-simulation-with-sram-macros">5.2. Back-Annotated Gate-Level Simulation with SRAM Macros</h3>
<p>Now that we have finished the place-and-route step, we need to use
back-annotated gate-level simulation to verify that the final design
still passes all of our tests.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>%<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/05-synopsys-vcs-baglsim
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/05-synopsys-vcs-baglsim
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>%<span class="w"> </span>vcs<span class="w"> </span>-sverilog<span class="w"> </span>-xprop<span class="o">=</span>tmerge<span class="w"> </span>-override_timescale<span class="o">=</span>1ns/1ps<span class="w"> </span>-top<span class="w"> </span>Top<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a><span class="w">    </span>+neg_tchk<span class="w"> </span>+sdfverbose<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a><span class="w">    </span>-sdf<span class="w"> </span>max:Top.DUT:../04-cadence-innovus-pnr/post-pnr.sdf<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-6"><a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a><span class="w">    </span>+define+CYCLE_TIME<span class="o">=</span><span class="m">2</span>.000<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-7"><a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a><span class="w">    </span>+define+VTB_INPUT_DELAY<span class="o">=</span><span class="m">0</span>.025<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-8"><a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a><span class="w">    </span>+define+VTB_OUTPUT_DELAY<span class="o">=</span><span class="m">0</span>.025<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-9"><a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a><span class="w">    </span>+define+VTB_DUMP_SAIF<span class="o">=</span>waves.saif<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-10"><a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a><span class="w">    </span>+vcs+dumpvars+waves.vcd<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-11"><a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a><span class="w">    </span>+incdir+<span class="si">${</span><span class="nv">TOPDIR</span><span class="si">}</span>/sim/build<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-12"><a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a><span class="w">    </span><span class="si">${</span><span class="nv">ECE6745_STDCELLS</span><span class="si">}</span>/stdcells.v<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-13"><a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a><span class="w">    </span>../00-openram-memgen/SRAM_32x128_1rw.v<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-14"><a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a><span class="w">    </span>../04-cadence-innovus-pnr/post-pnr.v<span class="w"> </span><span class="se">\</span>
</span><span id="__span-65-15"><a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a><span class="w">    </span><span class="si">${</span><span class="nv">TOPDIR</span><span class="si">}</span>/sim/build/SRAMMinion_noparam_sram-rtl-random_tb.v
</span><span id="__span-65-16"><a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a>%<span class="w"> </span>./simv
</span></code></pre></div>
<p>Let's open-up the waveforms using Surfer and verify that the
clock-to-data delay for the SRAM is about 300ps.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/05-synopsys-vcs-baglsim
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>%<span class="w"> </span>code<span class="w"> </span>waves.vcd
</span></code></pre></div>
<p>The following close-up shows the clock-to-data delay is indeed about
300ps.</p>
<p><img alt="" src="../img/tut10-sram-waveform.png" /></p>
<h3 id="53-power-analysis-with-sram-macros">5.3. Power Analysis with SRAM Macros</h3>
<p>Now we can use Synopsys PrimeTime (PT) for power analysis.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>%<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/06-synopsys-pt-pwr
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/build-tut10-sram/06-synopsys-pt-pwr
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a>%<span class="w"> </span>pt_shell
</span></code></pre></div>
<p>The initial setup similar to the previous tutorials, except we need to
provide Synopsys PT the <code>.db</code> files for the SRAM macro.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>pt_shell&gt; set_app_var target_library &quot;$env(ECE6745_STDCELLS)/stdcells.db ../00-openram-memgen/SRAM_32x128_1rw.db&quot;
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>pt_shell&gt; set_app_var link_library   &quot;* $env(ECE6745_STDCELLS)/stdcells.db ../00-openram-memgen/SRAM_32x128_1rw.db&quot;
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>pt_shell&gt; set_app_var power_enable_analysis true
</span></code></pre></div>
<p>We then read in the post-pnr gate-level netlist, the <code>.saif</code> file with
the activity factors from back-annotated gate-level simulation, and the
<code>.spef</code> file with the interconnect parasitics.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>pt_shell&gt; read_verilog ../04-cadence-innovus-pnr/post-pnr.v
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>pt_shell&gt; current_design SRAMMinion_noparam
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a>pt_shell&gt; link_design
</span><span id="__span-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a>pt_shell&gt; read_saif ../05-synopsys-vcs-baglsim/waves.saif -strip_path Top/DUT
</span><span id="__span-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a>pt_shell&gt; read_parasitics -format spef ../04-cadence-innovus-pnr/post-pnr.spef
</span></code></pre></div>
<p>Finally, we create the clock and perform the power analysis.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>pt_shell&gt; create_clock clk -name ideal_clock1 -period 2.000
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>pt_shell&gt; update_power
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>pt_shell&gt; report_power
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>pt_shell&gt; report_power -hierarchy
</span></code></pre></div>
<h2 id="6-asic-automated-flow-with-sram-macros">6. ASIC Automated Flow with SRAM Macros</h2>
<p>Manually entering commands is a great way to understand how the tools
work but is also tedious and error prone. The ASIC automated flow
includes support for using OpenRAM to generate SRAMs. We just need to
specify a list of SRAM macros we want to use in the YAML design file.
Take a look at the following YAML design file:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/designs
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a>%<span class="w"> </span>code<span class="w"> </span>tut10-sram.yml
</span></code></pre></div>
<p>The key to using SRAM macros is (1) adding <code>00-openram-memgen</code> as the
first step and (2) adding the the <code>sram_dir</code> and <code>srams</code> variables as
shown below.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>steps:
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a> - 00-openram-memgen
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a> - 01-synopsys-vcs-rtlsim
</span><span id="__span-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a> - 02-synopsys-dc-synth
</span><span id="__span-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a> - 03-synopsys-vcs-ffglsim
</span><span id="__span-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a> - 04-cadence-innovus-pnr
</span><span id="__span-72-7"><a id="__codelineno-72-7" name="__codelineno-72-7" href="#__codelineno-72-7"></a> - 05-synopsys-vcs-baglsim
</span><span id="__span-72-8"><a id="__codelineno-72-8" name="__codelineno-72-8" href="#__codelineno-72-8"></a> - 06-synopsys-pt-pwr
</span><span id="__span-72-9"><a id="__codelineno-72-9" name="__codelineno-72-9" href="#__codelineno-72-9"></a> - 07-summarize-results
</span><span id="__span-72-10"><a id="__codelineno-72-10" name="__codelineno-72-10" href="#__codelineno-72-10"></a>
</span><span id="__span-72-11"><a id="__codelineno-72-11" name="__codelineno-72-11" href="#__codelineno-72-11"></a>...
</span><span id="__span-72-12"><a id="__codelineno-72-12" name="__codelineno-72-12" href="#__codelineno-72-12"></a>
</span><span id="__span-72-13"><a id="__codelineno-72-13" name="__codelineno-72-13" href="#__codelineno-72-13"></a>sram_dir : ../../../sim/sram
</span><span id="__span-72-14"><a id="__codelineno-72-14" name="__codelineno-72-14" href="#__codelineno-72-14"></a>srams:
</span><span id="__span-72-15"><a id="__codelineno-72-15" name="__codelineno-72-15" href="#__codelineno-72-15"></a> - SRAM_32x128_1rw
</span></code></pre></div>
<p>The ASIC automated flow includes a new step template for using OpenRAM to
generate SRAMs. Take a look at the corresponding run script</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/steps/00-openram-memgen
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>%<span class="w"> </span>code<span class="w"> </span>run
</span></code></pre></div>
<p>The template at the bottom runs the <code>memgen</code> bash function for each SRAM
macro.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>{% for sram in srams | default([]) -%}
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>memgen {{sram}}
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>{% endfor %}
</span></code></pre></div>
<p>You should recognize the steps in the <code>memgen</code> bash function which
include running OpenRAM, copying the <code>.lib</code>, <code>.lef</code>, <code>.gds</code>, and <code>.v</code>
files, and running library compiler to generate the <code>.db</code> file.</p>
<p>Let's see some examples of how the remaining step templates include
support for using SRAM macros. First, let's look at the run scripts for
synthesis.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/asic/steps/02-synopsys-dc-synth
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>%<span class="w"> </span>code<span class="w"> </span>run.tcl
</span></code></pre></div>
<p>The key difference for synthesis is we need to include the <code>.db</code> file for
each SRAM macro.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>set_app_var target_library [list \
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>  &quot;$env(ECE6745_STDCELLS)/stdcells.db&quot; \
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a>  {% for sram in srams | default([]) -%}
</span><span id="__span-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a>  &quot;../00-openram-memgen/{{sram}}.db&quot; \
</span><span id="__span-76-5"><a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a>  {% endfor %}
</span><span id="__span-76-6"><a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a>]
</span></code></pre></div>
<p>For gate-level simulation we need to include the Verilog behavioral
models. Let's look at the run scripts for place-and-route.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>% cd $TOPDIR/asic/steps/04-cadence-innovus-pnr
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>% code run.tcl
</span></code></pre></div>
<p>The key difference is we need to include the <code>.lef</code> and <code>.gds</code> files for
each SRAM macro.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>set lef_files [list \
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>  &quot;$env(ECE6745_STDCELLS)/rtk-tech.lef&quot; \
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a>  &quot;$env(ECE6745_STDCELLS)/stdcells.lef&quot; \
</span><span id="__span-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a>  {% for sram in srams | default([]) -%}
</span><span id="__span-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a>  &quot;../00-openram-memgen/{{sram}}.lef&quot; \
</span><span id="__span-78-6"><a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a>  {% endfor %}
</span><span id="__span-78-7"><a id="__codelineno-78-7" name="__codelineno-78-7" href="#__codelineno-78-7"></a>]
</span><span id="__span-78-8"><a id="__codelineno-78-8" name="__codelineno-78-8" href="#__codelineno-78-8"></a>
</span><span id="__span-78-9"><a id="__codelineno-78-9" name="__codelineno-78-9" href="#__codelineno-78-9"></a>...
</span><span id="__span-78-10"><a id="__codelineno-78-10" name="__codelineno-78-10" href="#__codelineno-78-10"></a>
</span><span id="__span-78-11"><a id="__codelineno-78-11" name="__codelineno-78-11" href="#__codelineno-78-11"></a>set gds_files [list \
</span><span id="__span-78-12"><a id="__codelineno-78-12" name="__codelineno-78-12" href="#__codelineno-78-12"></a>  &quot;$env(ECE6745_STDCELLS)/stdcells.gds&quot; \
</span><span id="__span-78-13"><a id="__codelineno-78-13" name="__codelineno-78-13" href="#__codelineno-78-13"></a>  {% for sram in srams | default([]) -%}
</span><span id="__span-78-14"><a id="__codelineno-78-14" name="__codelineno-78-14" href="#__codelineno-78-14"></a>  &quot;../00-openram-memgen/{{sram}}.gds&quot; \
</span><span id="__span-78-15"><a id="__codelineno-78-15" name="__codelineno-78-15" href="#__codelineno-78-15"></a>  {% endfor %}
</span><span id="__span-78-16"><a id="__codelineno-78-16" name="__codelineno-78-16" href="#__codelineno-78-16"></a>]
</span></code></pre></div>
<p>We also need to make sure to include the <code>.lib</code> files in the
<code>setup-timing.tcl</code> script.</p>
<p>Now that we know understand how the step templates include support for
using SRAM macros, let's go ahead and push the SRAM val/rdy wrapper
through the ASIC automated flow. First let's delete the build directory
we have been using so far so we can start over.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>% cd $TOPDIR/asic
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>% trash build-tut10-sram
</span></code></pre></div>
<p>Now let's use pyhflow to generate the run scripts and go through each
step one at a time.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>% mkdir -p $TOPDIR/asic/build-tut10-sram
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>% cd $TOPDIR/asic/build-tut10-sram
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a>% pyhflow ../designs/tut10-sram.yml
</span><span id="__span-80-4"><a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a>% ./00-openram-memgen/run
</span><span id="__span-80-5"><a id="__codelineno-80-5" name="__codelineno-80-5" href="#__codelineno-80-5"></a>% ./01-synopsys-vcs-rtlsim/run
</span><span id="__span-80-6"><a id="__codelineno-80-6" name="__codelineno-80-6" href="#__codelineno-80-6"></a>% ./02-synopsys-dc-synth/run
</span><span id="__span-80-7"><a id="__codelineno-80-7" name="__codelineno-80-7" href="#__codelineno-80-7"></a>% ./03-synopsys-vcs-ffglsim/run
</span><span id="__span-80-8"><a id="__codelineno-80-8" name="__codelineno-80-8" href="#__codelineno-80-8"></a>% ./04-cadence-innovus-pnr/run
</span><span id="__span-80-9"><a id="__codelineno-80-9" name="__codelineno-80-9" href="#__codelineno-80-9"></a>% ./05-synopsys-vcs-baglsim/run
</span><span id="__span-80-10"><a id="__codelineno-80-10" name="__codelineno-80-10" href="#__codelineno-80-10"></a>% ./06-synopsys-pt-pwr/run
</span><span id="__span-80-11"><a id="__codelineno-80-11" name="__codelineno-80-11" href="#__codelineno-80-11"></a>% ./07-summarize-results/run
</span></code></pre></div>
<p>The summary results should be similar to as shown below.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a> timestamp           = 2025-04-06 13:32:59
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a> design_name         = SRAMMinion_noparam
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a> clock_period        = 2.0
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a> rtlsim              = 7/7 passed
</span><span id="__span-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a> synth_setup_slack   = 0.4255 ns
</span><span id="__span-81-6"><a id="__codelineno-81-6" name="__codelineno-81-6" href="#__codelineno-81-6"></a> synth_num_stdcells  = 354
</span><span id="__span-81-7"><a id="__codelineno-81-7" name="__codelineno-81-7" href="#__codelineno-81-7"></a> synth_area          = 11508.482 um^2
</span><span id="__span-81-8"><a id="__codelineno-81-8" name="__codelineno-81-8" href="#__codelineno-81-8"></a> ffglsim             = 7/7 passed
</span><span id="__span-81-9"><a id="__codelineno-81-9" name="__codelineno-81-9" href="#__codelineno-81-9"></a> pnr_setup_slack     = 0.3165 ns
</span><span id="__span-81-10"><a id="__codelineno-81-10" name="__codelineno-81-10" href="#__codelineno-81-10"></a> pnr_hold_slack      = 0.0102 ns
</span><span id="__span-81-11"><a id="__codelineno-81-11" name="__codelineno-81-11" href="#__codelineno-81-11"></a> pnr_clk_ins_src_lat = 0 ns
</span><span id="__span-81-12"><a id="__codelineno-81-12" name="__codelineno-81-12" href="#__codelineno-81-12"></a> pnr_num_stdcells    = 545
</span><span id="__span-81-13"><a id="__codelineno-81-13" name="__codelineno-81-13" href="#__codelineno-81-13"></a> pnr_area            = 11680.318 um^2
</span><span id="__span-81-14"><a id="__codelineno-81-14" name="__codelineno-81-14" href="#__codelineno-81-14"></a> baglsim             = 7/7 passed
</span><span id="__span-81-15"><a id="__codelineno-81-15" name="__codelineno-81-15" href="#__codelineno-81-15"></a>
</span><span id="__span-81-16"><a id="__codelineno-81-16" name="__codelineno-81-16" href="#__codelineno-81-16"></a> SRAMMinion_noparam_sram-rtl-random
</span><span id="__span-81-17"><a id="__codelineno-81-17" name="__codelineno-81-17" href="#__codelineno-81-17"></a>  - exec_time = 263 cycles
</span><span id="__span-81-18"><a id="__codelineno-81-18" name="__codelineno-81-18" href="#__codelineno-81-18"></a>  - exec_time = 526.0000 ns
</span><span id="__span-81-19"><a id="__codelineno-81-19" name="__codelineno-81-19" href="#__codelineno-81-19"></a>  - power     = 0.3296 mW
</span><span id="__span-81-20"><a id="__codelineno-81-20" name="__codelineno-81-20" href="#__codelineno-81-20"></a>  - energy    = 0.1734 nJ
</span></code></pre></div>
<h2 id="7-to-do-on-your-own">7. To-Do On Your Own</h2>
<p>Now that you understand how to use SRAM macros, try a simple experiment
to see the difference in energy when we only read/write zeros to the SRAM
macro. Our interactive simulator provides such a dataset.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>%<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOPDIR</span>/sim/build
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>%<span class="w"> </span>../tut10_sram/sram-sim<span class="w"> </span>--impl<span class="w"> </span>rtl<span class="w"> </span>--input<span class="w"> </span>allzero<span class="w"> </span>--translate<span class="w"> </span>--dump-vtb
</span></code></pre></div>
<p>Now modify the YAML design file to add this new evaluation.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a>evals:
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a> - SRAMMinion_noparam_sram-rtl-random
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a> - SRAMMinion_noparam_sram-rtl-allzero
</span></code></pre></div>
<p>Then you can regenerate the flow using pyhflow. There is no need to
regenerate the SRAM macros, rerun synthesis, or rerun place-and-route. We
can just just rerun four-state RTL, fast-functional gate-level,
back-annotated gate-level simulation, power analysis, and the final
summary.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a>% cd $TOPDIR/asic/build-tut10-sram
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a>% pyhflow ../designs/tut10-sram.yml
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a>% ./01-synopsys-vcs-rtlsim/run
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a>% ./03-synopsys-vcs-ffglsim/run
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a>% ./05-synopsys-vcs-baglsim/run
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6" href="#__codelineno-84-6"></a>% ./06-synopsys-pt-pwr/run
</span><span id="__span-84-7"><a id="__codelineno-84-7" name="__codelineno-84-7" href="#__codelineno-84-7"></a>% ./07-summarize-results/run
</span></code></pre></div>
<p>Compare the energy of the experiments with random data vs all zeros. Look
at the detailed energy reports.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>% cd $TOPDIR/asic/build-tut10-sram
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a>% code 06-synopsys-pt-pwr/SRAMMinion_noparam_sram-rtl-random-detailed.rpt
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a>% code 06-synopsys-pt-pwr/SRAMMinion_noparam_sram-rtl-allzero-detailed.rpt
</span></code></pre></div>
<p>The energy is not zero since even for the all zeros dataset the addresses
are random and choosing between read/writes is also random.</p>
<p>Now let's try another experiment to see the impact of column muxing.
Change the column muxing for the 32x128 SRAM macro from 4 to 2 by
updating the <code>words_per_row</code> variable in the <code>SRAM_32x128_1rw_cfg.py</code>
configuration file. Then delete the build directory we have been using so
far so we can start over.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>% cd $TOPDIR/asic
</span><span id="__span-86-2"><a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a>% trash build-tut10-sram
</span></code></pre></div>
<p>Use OpenRAM to regenerate the SRAM macros.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>% mkdir -p $TOPDIR/asic/build-tut10-sram
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>% cd $TOPDIR/asic/build-tut10-sram
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a>% pyhflow ../designs/tut10-sram.yml
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a>% ./00-openram-memgen/run
</span></code></pre></div>
<p>Take a look at the resulting layout using Klayout. Notice how the SRAM
array is much taller now, but also how the output flip-flops result in
quite a bit of white space. Go ahead and run the rest of the ASIC
automated flow.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>% cd $TOPDIR/asic/build-tut10-sram
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>% ./01-synopsys-vcs-rtlsim/run
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a>% ./02-synopsys-dc-synth/run
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a>% ./03-synopsys-vcs-ffglsim/run
</span><span id="__span-88-5"><a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a>% ./04-cadence-innovus-pnr/run
</span><span id="__span-88-6"><a id="__codelineno-88-6" name="__codelineno-88-6" href="#__codelineno-88-6"></a>% ./05-synopsys-vcs-baglsim/run
</span><span id="__span-88-7"><a id="__codelineno-88-7" name="__codelineno-88-7" href="#__codelineno-88-7"></a>% ./06-synopsys-pt-pwr/run
</span><span id="__span-88-8"><a id="__codelineno-88-8" name="__codelineno-88-8" href="#__codelineno-88-8"></a>% ./07-summarize-results/run
</span></code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Christopher Batten
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../js/extras.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.1.0/skins/default.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.1.0/wavedrom.min.js"></script>
      
        <script src="../js/wavedrom_loader.js"></script>
      
    
  </body>
</html>